<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ใบแจ้งหนี้</title>
    <style>
        body {
            background-color: rgb(71, 71, 71);
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }
        @page { size: A4; margin: 10mm; }  /* คุมระยะขอบกระดาษจริง */

  @media print {
    body { margin: 0; padding: 0; background: transparent !important; }
    /* กำหนดความกว้างเนื้อหาให้เล็กกว่าหน้ากระดาษเล็กน้อยและจัดกลาง */
    .a4-sheet { width: 210mm; min-height: 297mm; margin: 0 auto; }
    table { margin-left: auto; margin-right: auto; }
  }
 .a4-sheet > table[role="presentation"] {
    width: 190mm !important;
    height:297mm !important;           /* <<< ห้าม fix 297mm */
    margin: 0 auto !important;         /* <<< ตัด 12mm ที่ซ้อนกับ @page */
  } 
  /* สำหรับดูบนหน้าจอ */
  @media screen {
    .a4-sheet { width: 210mm; min-height: 297mm; margin: 0 auto; }
  }
    </style>
</head>
<body>
    <div class="a4-sheet">
    <table role="presentation" cellspacing="0" cellpadding="0"  style="width:190mm; height:297mm; margin:12mm auto;  color:#111827; border-collapse:collapse;    background: white;">
    <tr style="height: 300px;">
        <td>
        <table cellspacing="0" cellpadding="0"  style="width:100%; border-collapse:collapse;">
            <tr>
            <td style="width:60%; vertical-align:top;padding: 10px;">
                <table cellspacing="0" cellpadding="0" style="border-collapse:collapse;">
                <tr>
                    <td style="font-size:26px; font-weight:700; line-height:1 ;"><img src="picture/cwlogo.png" alt="" width="40px"></td>
                </tr>
                <tr>
                    <td style="padding:10px 0; font-weight:700; font-size: 10px;">บริษัท ซีดับบลิว ทาวเวอร์ จำกัด<br/>CW TOWERS CO., LTD.</td>
                </tr>
                <tr >
                <td colspan="2" style="padding:10px 0; font-size: 10px;">
                    <b>สํานักงานใหญ่:</b>&nbsp;&nbsp;&nbsp;&nbsp; 90 ถนนรัชดาภิเษก ห้วยขวาง กรุงเทพฯ 10310</td>
                </tr>
                <tr>
                <td colspan="2" style="padding:10px 0; font-size: 10px;">
                    <b>Head Office :</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 90, Ratchadapisek Road, HuaiKhwang, Bangkok 10310
                </td>
                </tr>
                <tr>
                <td style="padding:5px 0; font-size: 10px;"><b>เลขประจำตัวผู้เสียภาษี / Tax ID :</b> 0105559028333</td>
                </tr>
                <tr>
                <td style="padding:5px 0; font-size: 10px;"><b>contact Detail :</b>&nbsp;&nbsp;&nbsp;Tel  :   02-232-2939</td>
                </tr>
                <tr>
                    <td style="padding:5px 0 0 105px; font-size: 10px;">Email : accounting@cwtower.com</td>
                </tr>
                <tr>
                <td colspan="2" style="padding:10px 0; font-size: 10px;"><b>ชื่อ/Name :</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;117838:   บริษัท ชีพพลัส</td>
                </tr>
        <!-- ผู้ซื้อ/ที่อยู่/เลขที่ผู้เสียภาษี -->
        <tr>
            <td >
            <table style="width:100%; ">
                <tr>
                <td style="width:24%; font-size: 10px;"><b>ที่อยู่ /</b><b>Address :</b> </td>
                <td style="font-size: 10px;">
                    อาคาร ซีดับบลิว ทาวเวอร์ ทาวเวอร์บี ห้องเลขที่ 310 ชั้นที่ 3 เลขที่ 90 ถ.รัชดาภิเษก แขวงห้วยขวาง
                    เขตห้วยขวาง กรุงเทพฯ 10310
                </td>
                </tr>
                <tr>
                <td  colspan="2" style="font-size: 10px;"><b>ที่อยู่สํานักงานใหญ่ / Tax ID :</b><span style="padding: 0 0 0 10px">0195560001201 (HEAD OFFICE)</span></td>
                </tr>
            </table>
            </td>
        </tr>
                </table>
            </td>
            <td style="width:40%; vertical-align:top; text-align:right; padding: 10px;">
                <table cellspacing="0" cellpadding="0"  style="display:inline-table; border-collapse:collapse;">
                <tr>
                    <td style="font-size:8px; color:#6b7280; text-align:right;">หน้า/Page: 2/2</td>
                </tr>
                <tr>
                    <td style="padding-top:2px; font-size:10px; text-align:center;">ต้นฉบับ ORIGINAL</td>
                </tr>
                <tr>
                    <td style="font-size:12px; font-weight:700; text-transform:uppercase;padding:10px 0 0 0;text-align:center;">ใบแจ้งหนี้</td>
                </tr>
                <tr>
                    <td style="font-size:12px; font-weight:700; text-transform:uppercase;text-align:center;">INVOICE</td>
                </tr>
                <tr>
                    <td style="padding-top:10px;">
                    <table cellspacing="0" cellpadding="4" style="border-collapse:collapse;">
                        <tr>
                        <td style="text-align: center; width: 143px; font-size: 10px;"><b>เลขที่</b><br/>NO.<br/>00080089</td>
                        <td style="text-align: center; width: 143px; font-size: 10px;"><b>วันที่</b><br/>DATE<br/>05.08.2025</td>
                        </tr>
                    </table>
                    </td>
                </tr>
                <tr>
                    <td style="padding-top:10px;">
                    <table cellspacing="0" cellpadding="4" style="border-collapse:collapse; font-size: 10px;" >
                        <tr>
                        <td style="text-align: center; width: 68px;padding: 0;padding-bottom:14px;">สถานที่<br/>LOCATION<br/>CW Tower<br/></td>
                        <td style="text-align: center; width: 120px;padding: 0;">สัญญาเลขที่<br/>CONTRACT NO. CTW/LA-<br/>05.08.2025</td>
                        <td style="text-align: center; width: 120px;padding: 0;padding-bottom:14px;">วันที่ครบกำหนดชำระ<br/>UDATE<br/>05.08.2025</td>
                        </tr>
                    </table>
                    </td>
                </tr>

                </table>
                
            </td>
            
            </tr>
        </table>
                <!-- ตารางรายการ (หน่วยเป็น px) -->
<tr style="height: 450px;">
    <td style="padding: 0px 10px;"> <!-- เดิม 10mm 6mm 10mm -->
        <table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse; font-size:10px; color:#111;">
            <tr>
            <th style="border:1px solid #000; padding:6px; width:10px; text-align:center;">ลำดับ<br>NO.</th>          <!-- เดิม 12mm -->
            <th style="border:1px solid #000; padding:6px; text-align:center;">รายการ<br>DESCRIPTION</th>
            <th style="border:1px solid #000; padding:6px; width:80px;text-align: center;">จำนวนเงิน<br>AMOUNT</th>    <!-- เดิม 30mm -->
            <th style="border:1px solid #000; padding:6px; width:80px;text-align: center;">ภาษีมูลค่าเพิ่ม<br>VAT</th>  <!-- เดิม 25mm -->
            <th style="border:1px solid #000; padding:6px; width:98px;text-align: center;">จำนวนเงินรวม<br>TOTAL AMOUNT</th> <!-- เดิม 33mm -->
        </tr>

      <!-- รายการ 1-6 -->
        <tr>
                <td style="border-left: 1px solid #000;border-right: 1px solid #000;  text-align:center; height: 22px;padding:0px 6px;">1</td>
                <td style="padding:0px 6px; height: 22px;">308 · Rent 01.08.2025–31.08.2025</td>
                <td style="border-left: 1px solid #000; padding:0px 6px; text-align:right; height: 22px;">14,160.00</td>
                <td style="border-left: 1px solid #000; padding:0px 6px; text-align:right; height: 22px;">0.00</td>
                <td style="border-left: 1px solid #000; border-right: 1px solid #000; padding:0px 6px; text-align:right; height: 22px;">14,160.00</td>
        </tr>
        <tr style="height: 22px;">
            <td style="border-left: 1px solid #000;border-right: 1px solid #000; height: 22px;padding:0px 6px; text-align:center;">2</td>
            <td style="height: 22px;padding:0px 6px;">309 · Rent 01.08.2025–31.08.2025</td>
            <td style="border-left: 1px solid #000;height: 22px;padding:0px 6px; text-align:right;">17,110.00</td>
            <td style="border-left: 1px solid #000;height: 22px;padding:0px 6px; text-align:right;">0.00</td>
            <td style="border-left: 1px solid #000;border-right: 1px solid #000;height: 22px;padding:0px 6px; text-align:right;">17,110.00</td>
        </tr>
        <tr>
        <td style="border-left: 1px solid #000;border-right: 1px solid #000;height: 22px;padding:0px 6px; text-align:center;">3</td>
            <td style=" height: 22px;padding:0px 6px;">310 · Rent 01.08.2025–31.08.2025</td>
            <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;">67,260.00</td>
            <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;">0.00</td>
            <td style="border-left: 1px solid #000;    border-right: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;">67,260.00</td>
        </tr>
        <tr>
            <td style="border-left: 1px solid #000;border-right: 1px solid #000; height: 22px;padding:0px 6px; text-align:center;">4</td>
            <td style="height: 22px;padding:0px 6px;">308 · Service 01.08.2025–31.08.2025</td>
            <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;">14,160.00</td>
            <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;">991.20</td>
            <td style="border-left: 1px solid #000; border-right: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;">15,151.20</td>
        </tr>
        <tr>
            <td style="border-left: 1px solid #000;border-right: 1px solid #000; height: 22px;padding:0px 6px; text-align:center;">5</td>
            <td style="height: 22px;padding:0px 6px;">309 · Service 01.08.2025–31.08.2025</td>
            <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;">17,110.00</td>
            <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;">1,197.70</td>
            <td style="border-left: 1px solid #000;border-right: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;">18,307.70</td>
        </tr>
        <tr>
        <td style="border-left: 1px solid #000;border-right: 1px solid #000;height: 22px;padding:0px 6px; text-align:center;">6</td>
        <td style="height: 22px;padding:0px 6px;">310 · Service 01.08.2025–31.08.2025</td>
        <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;">67,260.00</td>
        <td style="border-left: 1px solid #000;height: 22px;padding:0px 6px; text-align:right;">4,708.20</td>
        <td style="border-left: 1px solid #000; border-right: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;">71,968.20</td>
    </tr>

    <!-- ช่องว่าง -->
   <tr>
        <td style="border-left: 1px solid #000;border-right: 1px solid #000;height: 22px;padding:0px 6px; text-align:center;"></td>
        <td style="height: 22px;padding:0px 6px;"></td>
        <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
        <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
        <td style="border-left: 1px solid #000; border-right: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
    </tr>
    <tr>
        <td style="border-left: 1px solid #000;border-right: 1px solid #000;height: 22px;padding:0px 6px; text-align:center;"></td>
        <td style="height: 22px;padding:0px 6px;"></td>
        <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
        <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
        <td style="border-left: 1px solid #000; border-right: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
    </tr>
    <tr>
        <td style="border-left: 1px solid #000;border-right: 1px solid #000;height: 22px;padding:0px 6px; text-align:center;"></td>
        <td style="height: 22px;padding:0px 6px;"></td>
        <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
        <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
        <td style="border-left: 1px solid #000; border-right: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
    </tr>
    <tr>
        <td style="border-left: 1px solid #000;border-right: 1px solid #000;height: 22px;padding:0px 6px; text-align:center;"></td>
        <td style="height: 22px;padding:0px 6px;"></td>
        <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
        <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
        <td style="border-left: 1px solid #000; border-right: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
    </tr><tr>
        <td style="border-left: 1px solid #000;border-right: 1px solid #000;height: 22px;padding:0px 6px; text-align:center;"></td>
        <td style="height: 22px;padding:0px 6px;"></td>
        <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
        <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
        <td style="border-left: 1px solid #000; border-right: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
    </tr><tr>
        <td style="border-left: 1px solid #000;border-right: 1px solid #000;height: 22px;padding:0px 6px; text-align:center;"></td>
        <td style="height: 22px;padding:0px 6px;"></td>
        <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
        <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
        <td style="border-left: 1px solid #000; border-right: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
    </tr>
    <tr>
        <td style="border-left: 1px solid #000;border-right: 1px solid #000;height: 22px;padding:0px 6px; text-align:center;"></td>
        <td style="height: 22px;padding:0px 6px;"></td>
        <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
        <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
        <td style="border-left: 1px solid #000; border-right: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
    </tr>
    <tr>
        <td style="border-left: 1px solid #000;border-right: 1px solid #000;height: 22px;padding:0px 6px; text-align:center;"></td>
        <td style="height: 22px;padding:0px 6px;"></td>
        <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
        <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
        <td style="border-left: 1px solid #000; border-right: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
    </tr>
    <tr>
        <td style="border-left: 1px solid #000;border-right: 1px solid #000;height: 22px;padding:0px 6px; text-align:center;"></td>
        <td style="height: 22px;padding:0px 6px;"></td>
        <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
        <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
        <td style="border-left: 1px solid #000; border-right: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
    </tr><tr>
        <td style="border-left: 1px solid #000;border-right: 1px solid #000;height: 22px;padding:0px 6px; text-align:center;"></td>
        <td style="height: 22px;padding:0px 6px;"></td>
        <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
        <td style="border-left: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
        <td style="border-left: 1px solid #000; border-right: 1px solid #000; height: 22px;padding:0px 6px; text-align:right;"></td>
    </tr>

    <tr>
        </tr>
            <tr>
                <td style="border-left:1px solid #000; border-right:1px solid #000; padding:0;"></td>
                <td style="border-left:1px solid #000; border-right:1px solid #000; padding:0;"></td>
                <td  colspan="2" style="border:1px solid #000; padding:6px;">รวมมูลค่าสินค้าและบริการ/Subtotal</td>
                <td style="border:1px solid #000; padding:6px; text-align:right;">197,060.00</td>
            </tr>
        <tr>
            <td style="border-left:1px solid #000; border-right:1px solid #000; padding:0;"></td>
            <td style="border-left:1px solid #000; border-right:1px solid #000; padding:0;"></td>
            <td  colspan="2" style="border:1px solid #000; padding:6px;">รวมภาษีมูลค่าเพิ่ม/VAT</td>
            <td style="border:1px solid #000; padding:6px; text-align:right;">197,060.00</td>
        </tr>
    <tr>
        <td colspan="2" style="border-left:1px solid #000; border-right:1px solid #000; padding:0;">
            <table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse; font-size:12px;">
                    <tr>
                    <td style="border-top: 1px solid #000;    border-right: 1px solid #000; text-align:center; width:33.33%; height: 27px; font-size: 10px;">Withholding tax 3.00 %</td>
                    <td style="border-top: 1px solid #000;    border-right: 1px solid #000; text-align:center; width:33.33%; height: 27px; font-size: 10px;">Withholding tax 5.00 %</td>
                    <td style="border-top: 1px solid #000; text-align:center; height: 27px; font-size: 10px;">Total Withholding tax</td>
                    </tr>
                </table>
        </td>
        <td colspan="2"  style="border:1px solid #000; padding:6px;">จำนวนเงินรวมภาษีมูลค่าเพิ่ม/Total</td>
        <td style="border:1px solid #000; padding:6px; text-align:right;">197,060.00</td>
        </tr>
        <tr>
        <td colspan="2">
                        <table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse; font-size:12px;">
                    <tr>
                    <td style="border:1px solid #000; text-align:center; width:33.33%; height: 27px; font-size: 10px;">2,955.90</td>
                    <td style="border:1px solid #000; text-align:center; width:33.33%; height: 27px; font-size: 10px;">4,926.50</td>
                    <td style="  text-align:center; height: 27px;border-top: 1px solid black; border-bottom: 1px solid black;font-size: 10px;">7,882.40</td>
                    </tr>
                </table>
        </td>
            <td colspan="2" style="border:1px solid #000; padding:6px;">หักภาษี ณ ที่จ่าย/Withholding tax</td>
            <td style="border:1px solid #000; padding:6px; text-align:right;">197,060.00</td>
        </tr>
        <tr>
            <td colspan="2"></td>
            <td colspan="2" style="border:1px solid #000; padding:6px;">จำนวนเงินสุทธิทั้งสิ้น/Grand total</td>
            <td style="border:1px solid #000; padding:6px; text-align:right;">197,060.00</td>
        </tr>
    </table>

    <table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse; margin-top:6px; font-size:8px;">
    <tr style="height: 25px;">
        <td style="padding:0; ">ตัวอักษรเป็น word : **ONE HUNDRED NINETY-SIX THOUSAND SEVENTY-FOUR Baht AND SEVENTY Satang**</td>
    </tr>
    </table>
    <!-- ก้อน 1 : Remark -->
    <tr>
    <td style="padding: 0px 10px 0 10px;">
        <table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse; font-size:12px; color:#111; font-size: 10px;">
        <tr>
            <td style="font-weight:700; padding:0 0 6px 0;">หมายเหตุ/Remark</td>
        </tr>
        <tr>
            <td style="line-height:1.6;">
            1. โปรดชำระเงินภายในกำหนดเวลา บริษัทฯ จะคิดค่าเบี้ยปรับเป็นรายเดือน นับจากวันที่เกินกำหนดจนถึงวันที่บริษัทฯ ได้รับชำระเงินเต็มจำนวน<br>
            2. หากเอกสารผิดพลาด กรุณาแจ้งให้บริษัทฯ ทราบ ภายใน 7 วัน นับจากวันที่พิมพ์เอกสารฉบับนี้<br>
            3. การหักภาษี ณ ที่จ่าย โปรดส่งหนังสือรับรองฯ มาที่บริษัทฯ ทุกครั้ง (ที่อยู่ตามส่วนหัวเอกสาร)<br>
            4. โปรดชำระโดย โอนเงิน/เช็คสั่งจ่าย ไปยังชื่อบัญชีตามด้านล่าง และส่งหลักฐานการชำระเงินมาที่ Email : Finance@cwtower.com
            </td>
        </tr>
        </table>
    </td>
    </tr>

    <!-- ก้อน 2 : ข้อมูลชำระเงิน (ไทยซ้าย / อังกฤษขวา) -->
    <tr>
    <td style="padding: 0 10px 0px 10px;">
        <table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse; color:#111; font-size: 10px;">
        <tr>
            <!-- ซ้าย: ไทย -->
            <td style="vertical-align:top; width:38%; padding-right:20px;">
            <table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse; font-size: 10px;">
                <tr>
                <td style="font-weight:700; padding:0 0 6px 0;">โปรดชำระเงินเข้าบัญชีตามรายละเอียดต่อไปนี้ :</td>
                </tr>
                <tr>
                <td style="padding-bottom:10px;">บริษัท ซีดับบลิว ทาวเวอร์ จำกัด</td>
                </tr>
                <tr>
                <td style="line-height:1.8;">
                    <table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse; font-size:10px;">
                    <tr>
                        <td style="width:72px;"><b>ชื่อธนาคาร :</b></td>
                        <td>ธนาคารกสิกรไทย จำกัด (มหาชน) / สีลม</td>
                    </tr>
                    <tr>
                        <td style="padding-bottom:10px;"><b>ชื่อบัญชี :</b></td>
                        <td style="padding-bottom:10px;">บริษัท ซีดับบลิว ทาวเวอร์ จำกัด</td>
                    </tr>
                    <tr>
                        <td><b>เลขที่บัญชี :</b></td>
                        <td>015-8-29055-3</td>
                    </tr>
                    </table>
                </td>
                </tr>
            </table>
            </td>

            <!-- ขวา: อังกฤษ -->
            <td style="vertical-align:top; width:42%;">
            <table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse; font-size: 10px;">
                <tr>
                <td style="font-weight:700; padding:0 0 6px 0; text-align:left;">Please make payment :</td>
                </tr>
                <tr>
                <td style="padding-bottom:10px;">CW TOWERS CO., LTD</td>
                </tr>
                <tr>
                <td>
                    <table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse; font: size 10px; line-height:1.8;">
                    <tr>
                        <td style="width:110px;">Bank Name:</td>
                        <td>Kasikorn Bank Public Company Limited / Silom</td>
                    </tr>
                    <tr>
                        <td style="padding-bottom:10px;">Name of account:</td>
                        <td style="padding-bottom:10px;">CW TOWERS CO., LTD.</td>
                    </tr>
                    <tr>
                        <td>Bank A/C No.:</td>
                        <td>015-8-29055-3</td>
                    </tr>
                    </table>
                </td>
                </tr>
            </table>
            </td>
        </tr>
        </table>
    </td>
    </tr>


<!-- บรรทัดล่าง: หมายเหตุลายเซ็น/ผู้รับ/วันที่พิมพ์ -->
    <tr>
    <td style="padding: 0px 10px;">
        <table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse; font-size:10px; color:#111;">
        <tr>
            <td style="vertical-align:top; width:55%;">
            เอกสารฉบับนี้จัดทำโดยระบบคอมพิวเตอร์ของบริษัทฯ จึงไม่ต้องลงนามผู้จัดทำ<br>
            <span style="font-weight:700;">NO SIGNATURE IS REQUIRED FOR COMPUTER GENERATED DOCUMENT</span>
            </td>
        </tr>
        </table>
    </td>
    </tr>

<tr>
<td style="padding: 0 10px 10px 10px;">
    <table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse; font-size:10px; color:#111;">
    <tr>
        <td style=" width:40%; text-align: left;">ผู้รับ/RECEIVED BY</td>
        <td style=" width:15%; text-align:center; padding:0;">
        <table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse;">
            <!-- แถวเส้นปะ (พื้นที่เซ็นชื่อ) -->
            <tr>
            <td>&nbsp;................................................</td>
            </tr>
            <!-- แถวหัวข้อใต้เส้นปะ -->
            <tr>
            <td style="text-align:center;">ผู้รับ/RECEIVED BY</td>
            </tr>
        </table>
        </td>
        <td style=" width:20%; text-align:right; font-size: 6px;">วันที่พิมพ์/Printed Date: 08.07.2025</td>
    </tr>
    </table>
</td>
</tr>
</td>
</tr>
        </td>
    </tr>
    </table>
    </div>
    <script>
// ฟังก์ชันสำหรับรับ ID จาก URL parameter
function getUrlParameter(name) {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get(name);
}

// ฟังก์ชันสำหรับดึงข้อมูลจาก API
function loadReceiptData(receiptId) {
    if (!receiptId) {
        console.error('ไม่พบ ID ของใบเสร็จ');
        return;
    }
    
    console.log('กำลังดึงข้อมูลสำหรับ ID:', receiptId);
    
    // กำหนด endpoint 
    const endpoint = 'http://localhost:3000';
    
    $.ajax({
        url: `${endpoint}/api/get_quotation_by_id`,
        method: 'POST',
        dataType: 'json',
        contentType: 'application/json',
        data: JSON.stringify({
            id: receiptId,
            com_id: localStorage.getItem('com_id') || 1
        }),
        success: function(response) {
            console.log('API Response:', response);
            if (response.code === 200) {
                // อัปเดตข้อมูลในหน้าเว็บ
                updateReceiptDisplay(response.result);
            } else {
                console.error('เกิดข้อผิดพลาดในการดึงข้อมูล:', response.result);
                alert('ไม่สามารถดึงข้อมูลได้: ' + (response.result || 'ไม่ทราบสาเหตุ'));
            }
        },
        error: function(xhr, status, error) {
            console.error('เกิดข้อผิดพลาดในการเชื่อมต่อ:', error);
            alert('เกิดข้อผิดพลาดในการเชื่อมต่อกับเซิร์ฟเวอร์');
        }
    });
}

// ฟังก์ชันสำหรับอัปเดตข้อมูลในหน้าเว็บ
function updateReceiptDisplay(data) {
// ข้อมูลลูกค้า
  $('#customerName').text(data.cus_name);
  
  // แบ่งที่อยู่จาก customerAddress
  var fullAddress = data.cus_detail.cus_addr || '';
  
  // หาตำแหน่งของคำสำคัญในที่อยู่
  var tambonIndex = fullAddress.search(/ต\.|ตำบล|แขวง/);
  var amphoeIndex = fullAddress.search(/อ\.|อำเภอ|เขต/);
  var provinceIndex = fullAddress.search(/จ\.|จังหวัด|กรุงเทพมหานคร|กรุงเทพฯ|กรุงเทพ ฯ/);
  
  if (tambonIndex !== -1) {
    // บรรทัดที่ 1: ที่อยู่หลัก (ก่อนตำบล)
    $('#customerAddress').text(fullAddress.substring(0, tambonIndex).trim());
    
    if (provinceIndex !== -1) {
      // บรรทัดที่ 2: ตำบล อำเภอ
      $('#customerAddress2').text(fullAddress.substring(tambonIndex, provinceIndex).trim());
      // บรรทัดที่ 3: จังหวัด รหัสไปรษณีย์
      $('#customerAddress3').text(fullAddress.substring(provinceIndex).trim());
    }
  }
  $('#customerPhone').text(data.cus_detail.cus_phone);
  $('#customerReference').text(data.cus_detail.cus_refer);

// ข้อมูลใบเสนอราคา
  $('#quotationNumber').text(data.tx);
  $('#quotationDate').text(data.doc_date);
  $('#quotationDueDate').text(data.doc_detail.deadline);
  $('#quotationDueDateTo').text(data.due_date);
  $('#quotationPaymentTerms').text(data.quo_payment_terms);

// ข้อมูลสินค้า
  const items = data.product_byuser.slice(0, 10);
  const emptyRows = [];
  
  // เพิ่มแถวว่างจนครบ 10 แถว
  for (let i = items.length; i < 10; i++) {
    emptyRows.push(`
      <tr>
        <td style="border-left: 1px solid black; height:40px;text-align: center;font-size: 11px;"></td>
        <td style="border-left: 1px solid black;padding: 0 10px; border-left: 1px solid black;font-size: 11px;">&nbsp;</td>
        <td style="border-left: 1px solid black;text-align: center;font-size: 11px;">&nbsp;</td>
        <td style="border-left: 1px solid black;font-size: 11px;text-align: right;padding: 0 10px;">&nbsp;</td>
        <td style="border-left: 1px solid black;font-size: 11px;text-align: right;padding: 0 10px;">&nbsp;</td>
        <td style="border-left: 1px solid black;border-right: 1px solid black;font-size: 11px;text-align: right;padding: 0 10px;">&nbsp;</td>
      </tr>
    `);
  }
  
  $('#quotationItems').html([
    ...items.map((item, index) => `
      <tr>
        <td style="border-left: 1px solid black; height:40px;text-align: center;font-size: 11px;">${index + 1}</td>
        <td style="border-left: 1px solid black;padding: 0 10px; border-left: 1px solid black;font-size: 11px;">${item.desc_product}</td>
        <td style="border-left: 1px solid black;text-align: center;font-size: 11px;">${parseFloat(item.qty).toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0})}</td>
        <td style="border-left: 1px solid black;font-size: 11px;text-align: right;padding: 0 10px;">${parseFloat(item.price).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
        <td style="border-left: 1px solid black;font-size: 11px;text-align: right;padding: 0 10px;">${parseFloat(item.discount).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
        <td style="border-left: 1px solid black;border-right: 1px solid black;font-size: 11px;text-align: right;padding: 0 10px;">${parseFloat(item.total).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
      </tr>
    `),
    ...emptyRows
  ].join(''));

  
  // ข้อมูลยอดรวม
  $('#subtotal').text(parseFloat(data.product_detail.product_totalAllProducts).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}));
  $('#totalDiscount').text(parseFloat(data.product_detail.product_totalDiscount).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}));
  $('#afterDiscount').text(parseFloat(data.product_detail.product_totalAfterDiscount).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}));
  $('#vatAmount').text(parseFloat(data.product_detail.product_totalTax).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}));
  
  // รวม withholdingTax ทั้ง 3 อัน
  const withholdingTax1 = parseFloat(data.product_detail.product_withholdingTax) || 0;
  const withholdingTax2 = parseFloat(data.product_detail.product_withholdingTax2) || 0;
  const withholdingTax3 = parseFloat(data.product_detail.product_withholdingTax3) || 0;
  const totalWithholdingTax = withholdingTax1 + withholdingTax2 + withholdingTax3;
  $('#taxAmount').text(totalWithholdingTax.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}));
  
  $('#grandTotal').text(parseFloat(data.product_detail.product_totalAll).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}));

  // แปลงตัวเลขเป็นตัวอักษรไทย
  const grandTotalAmount = parseFloat(data.product_detail.product_totalAll);
  const thaiText = convertToThaiText(grandTotalAmount);
  $('#totalText').text(`ตัวอักษร: (${thaiText})`);

  // อัปเดตการแสดงลายเซ็นต์อิเล็กทรอนิกและตารายาง  
  if (data.cus_detail && data.cus_detail.cus_visits !== undefined) {
    updateSignatureDisplay(data.cus_detail.cus_visits);
  }

  console.log('อัปเดตข้อมูลเรียบร้อยแล้ว');
  createNewPage(data);
}

// ฟังก์ชันสำหรับอัปเดตชื่อผู้จัดทำและสถานะ checkbox
function updateCreatorDisplay() {
    const creatorName = localStorage.getItem('quotationCreatorName');
    const notShowName = localStorage.getItem('quotationNotShowName') === 'true';
    const signatureOption = localStorage.getItem('quotationSignatureOption') === 'true';
    
    const creatorElement = document.getElementById('creatorName');
    
    if (creatorName) {
        creatorElement.textContent = creatorName;
    }
    
    // ควบคุมการแสดงชื่อผู้จัดทำตามสถานะ checkbox
    if (notShowName) {
        // ถ้าเลือก "ไม่แสดงชื่อผู้จัดทำ" ให้ซ่อนชื่อ
        creatorElement.style.display = 'none';
    } else if (signatureOption) {
        // ถ้าเลือก "ลายเซ็นต์อิเล็กทรอนิก" ให้แสดงชื่อ
        creatorElement.style.display = 'visible';
    } else {
        // ถ้าไม่เลือกอะไรเลย ให้ซ่อนชื่อ
        creatorElement.style.display = 'none';
    }
}

// ฟังก์ชันสำหรับลายเซ็นต์อิเล็กทรอนิกและตารางลายเซ็นตาม cus_visits
function updateSignatureDisplay(cusVisits) {
    const unitLogo = document.getElementById('unitLogo');
    
    // ตรวจสอบ cus_visits
    if (cusVisits === true || cusVisits === 'true') {
        // ถ้า cus_visits เป็น true ให้แสดงลายเซ็น
        unitLogo.style.display = 'block';
    } else {
        // ถ้า cus_visits ไม่เป็น true ให้ซ่อนลายเซ็น
        unitLogo.style.display = 'none';
    }
}

// ฟังก์ชันแปลงตัวเลขเป็นตัวอักษรไทย
function convertToThaiText(number) {
    const thaiNumbers = ['ศูนย์', 'หนึ่ง', 'สอง', 'สาม', 'สี่', 'ห้า', 'หก', 'เจ็ด', 'แปด', 'เก้า'];
    const thaiUnits = ['', 'สิบ', 'ร้อย', 'พัน', 'หมื่น', 'แสน', 'ล้าน'];
    
    if (number === 0) return 'ศูนย์บาทถ้วน';
    
    const integerPart = Math.floor(number);
    const decimalPart = Math.round((number - integerPart) * 100);
    
    let result = '';
    
    // แปลงส่วนจำนวนเต็ม
    if (integerPart > 0) {
        const numStr = integerPart.toString();
        const len = numStr.length;
        
        for (let i = 0; i < len; i++) {
            const digit = parseInt(numStr[i]);
            const position = len - i - 1;
            
            if (digit !== 0) {
                if (position === 1 && digit === 1 && len > 1) {
                    result += 'สิบ';
                } else if (position === 1 && digit === 2) {
                    result += 'ยี่สิบ';
                } else if (position === 0 && digit === 1 && len > 1) {
                    result += 'เอ็ด';
                } else {
                    result += thaiNumbers[digit];
                    if (position > 0) {
                        result += thaiUnits[position];
                    }
                }
            }
        }
        result += 'บาท';
    }
    
    // แปลงส่วนทศนิยม
    if (decimalPart > 0) {
        const decimalStr = decimalPart.toString();
        for (let i = 0; i < decimalStr.length; i++) {
            const digit = parseInt(decimalStr[i]);
            if (digit !== 0) {
                result += thaiNumbers[digit];
                if (i === 0) result += 'สิบ';
            }
        }
        result += 'สตางค์';
    } else {
        result += 'ถ้วน';
    }
    
    return result;
}

// ฟังก์ชันสำหรับสร้างหลายหน้า
function createNewPage(data) {
  const items = data.product_byuser;
  
  // ถ้ามีรายการเกิน 10 รายการ ให้สร้างหน้าใหม่
  if (items.length > 10) {
    const totalPages = Math.ceil(items.length / 10);
    
    // ตั้งค่าหน้าแสดงยอดรวมหน้าแรก
    $('#subtotal').text('0.00');
    $('#totalDiscount').text('0.00');
    $('#afterDiscount').text('0.00');
    $('#vatAmount').text('0.00');
    $('#taxAmount').text('0.00');
    $('#grandTotal').text('0.00');
    $('#totalText').text('ตัวอักษร: (ศูนย์บาทถ้วน)');
    
    for (let pageIndex = 1; pageIndex < totalPages; pageIndex++) {
      const startIndex = pageIndex * 10;
      const endIndex = Math.min(startIndex + 10, items.length);
      const pageItems = items.slice(startIndex, endIndex);
      const isLastPage = (pageIndex === totalPages - 1);
      
      // สร้าง div ใหม่สำหรับหน้าใหม่
      const newPageDiv = document.createElement('div');
      newPageDiv.className = 'a4-sheet';
      
      // คัดลอกโครงสร้างจากหน้าแรก
      const originalDiv = document.querySelector('.a4-sheet');
      newPageDiv.innerHTML = originalDiv.innerHTML;
      
      // ลบรายการสินค้าเก่าออก
      const tbody = newPageDiv.querySelector('#quotationItems');
      tbody.innerHTML = '';
      
      // เพิ่มรายการสินค้าสำหรับหน้านี้
      const emptyRows = [];
      
      // เพิ่มแถวว่างจนครบ 10 แถว
      for (let i = pageItems.length; i < 10; i++) {
        emptyRows.push(`
          <tr>
            <td style="border-left: 1px solid black; height:40px;text-align: center;font-size: 11px;"></td>
            <td style="border-left: 1px solid black;padding: 0 10px; border-left: 1px solid black;font-size: 11px;">&nbsp;</td>
            <td style="border-left: 1px solid black;text-align: center;font-size: 11px;">&nbsp;</td>
            <td style="border-left: 1px solid black;font-size: 11px;text-align: right;padding: 0 10px;">&nbsp;</td>
            <td style="border-left: 1px solid black;font-size: 11px;text-align: right;padding: 0 10px;">&nbsp;</td>
            <td style="border-left: 1px solid black;border-right: 1px solid black;font-size: 11px;text-align: right;padding: 0 10px;">&nbsp;</td>
          </tr>
        `);
      }
      
      tbody.innerHTML = [
        ...pageItems.map((item, index) => `
          <tr>
            <td style="border-left: 1px solid black; height:40px;text-align: center;font-size: 11px;">${startIndex + index + 1}</td>
            <td style="border-left: 1px solid black;padding: 0 10px; border-left: 1px solid black;font-size: 11px;">${item.desc_product}</td>
            <td style="border-left: 1px solid black;text-align: center;font-size: 11px;">${parseFloat(item.qty).toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0})}</td>
            <td style="border-left: 1px solid black;font-size: 11px;text-align: right;padding: 0 10px;">${parseFloat(item.price).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
            <td style="border-left: 1px solid black;font-size: 11px;text-align: right;padding: 0 10px;">${parseFloat(item.discount).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
            <td style="border-left: 1px solid black;border-right: 1px solid black;font-size: 11px;text-align: right;padding: 0 10px;">${parseFloat(item.total).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
          </tr>
        `),
        ...emptyRows
      ].join('');
      
      // ตั้งค่ายอดรวมสำหรับหน้านี้
      if (isLastPage) {
        // หน้าสุดท้าย: แสดงยอดรวมจริง
        newPageDiv.querySelector('#subtotal').textContent = parseFloat(data.product_detail.product_totalAllProducts).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
        newPageDiv.querySelector('#totalDiscount').textContent = parseFloat(data.product_detail.product_totalDiscount).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
        newPageDiv.querySelector('#afterDiscount').textContent = parseFloat(data.product_detail.product_totalAfterDiscount).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
        newPageDiv.querySelector('#vatAmount').textContent = parseFloat(data.product_detail.product_totalTax).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
        
        // รวม withholdingTax ทั้ง 3 อัน
        const withholdingTax1 = parseFloat(data.product_detail.product_withholdingTax) || 0;
        const withholdingTax2 = parseFloat(data.product_detail.product_withholdingTax2) || 0;
        const withholdingTax3 = parseFloat(data.product_detail.product_withholdingTax3) || 0;
        const totalWithholdingTax = withholdingTax1 + withholdingTax2 + withholdingTax3;
        newPageDiv.querySelector('#taxAmount').textContent = totalWithholdingTax.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
        
        newPageDiv.querySelector('#grandTotal').textContent = parseFloat(data.product_detail.product_totalAll).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
        
        // แสดงตัวอักษรเฉพาะหน้าสุดท้าย
        const grandTotalAmount = parseFloat(data.product_detail.product_totalAll);
        const thaiText = convertToThaiText(grandTotalAmount);
        newPageDiv.querySelector('#totalText').textContent = `ตัวอักษร: (${thaiText})`;
      } else {
        // หน้าก่อนหน้า: แสดงยอดรวมเป็น 0.00
        newPageDiv.querySelector('#subtotal').textContent = '0.00';
        newPageDiv.querySelector('#totalDiscount').textContent = '0.00';
        newPageDiv.querySelector('#afterDiscount').textContent = '0.00';
        newPageDiv.querySelector('#vatAmount').textContent = '0.00';
        newPageDiv.querySelector('#taxAmount').textContent = '0.00';
        newPageDiv.querySelector('#grandTotal').textContent = '0.00';
      }
      
      // เพิ่มหน้าใหม่ลงใน body
      document.body.appendChild(newPageDiv);
    }
  }
}

// ฟังก์ชันสำหรับดาวน์โหลด PDF
function downloadPDF() {
  const elements = document.querySelectorAll(".a4-sheet");
  
  // ดึงข้อมูล tx 
  const txElement = document.getElementById('quotationNumber');
  const txValue = txElement ? txElement.textContent : '';
  const filename = `ใบเสนอราคา${txValue}.pdf`;
  
  // สร้าง PDF ใหม่
  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF('p', 'mm', 'a4');
  
  let pageIndex = 0;
  
  // ฟังก์ชันสำหรับประมวลผลหน้าต่อไป
  function processNextPage(index) {
    if (index >= elements.length) {
      // บันทึก PDF เมื่อประมวลผลทุกหน้าเสร็จ
      pdf.save(filename);

      return;
    }
    
    const element = elements[index];
    
    // สร้าง canvas จาก element
    html2canvas(element, {
      scale: 2,
      useCORS: true,
      allowTaint: true,
      scrollX: 0,
      scrollY: 0,
      height: 1100,
      windowHeight: 1100
    }).then(function(canvas) {
      const imgData = canvas.toDataURL('image/jpeg', 1.0);
      
      // เพิ่มหน้าใหม่ใน PDF (ยกเว้นหน้าแรก)
      if (index > 0) {
        pdf.addPage();
      }
      
      const imgWidth = 210; // A4 width in mm
      const pageHeight = 297; // A4 height in mm
      const imgHeight = (canvas.height * imgWidth) / canvas.width;
      let heightLeft = imgHeight;
      let position = 0;
      
      pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
      heightLeft -= pageHeight;
      
      while (heightLeft >= 0) {
        position = heightLeft - imgHeight;
        pdf.addPage();
        pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
        heightLeft -= pageHeight;
      }
      
      // ประมวลผลหน้าต่อไป
      processNextPage(index + 1);
    }).catch(function(error) {
      console.error('เกิดข้อผิดพลาดในการสร้าง canvas:', error);
      alert('เกิดข้อผิดพลาดในการสร้าง PDF: ' + error.message);
    });
  }
  
  // เริ่มประมวลผลทุกหน้า
  processNextPage(0);
}

// ฟังก์ชันสำหรับพิมพ์
function printDocument() {
    // ซ่อนปุ่มพิมพ์และดาวน์โหลดก่อนพิมพ์
    const buttons = document.querySelectorAll('.print-button, .download-button, .button-container');
    buttons.forEach(button => {
        button.style.display = 'none';
    });
    
    // เรียกใช้ฟังก์ชันพิมพ์ของเบราว์เซอร์
    window.print();
    
    // แสดงปุ่มกลับมาหลังพิมพ์เสร็จ
    setTimeout(() => {
        buttons.forEach(button => {
            button.style.display = '';
        });
    }, 1000);
}


// เรียกใช้ฟังก์ชันเมื่อโหลดหน้าเสร็จ
$(document).ready(function() {
    // อัปเดตการแสดงชื่อผู้จัดทำตามสถานะ checkbox
    updateCreatorDisplay();
    
    const Id = getUrlParameter('id');
    if (Id) {
        console.log('ได้รับ ID :', Id);
        // เรียกใช้ฟังก์ชันดึงข้อมูลจาก API
        loadReceiptData(Id);
    } else {
        console.log('ไม่พบ ID');
    }
});
</script>
</body>
</html>