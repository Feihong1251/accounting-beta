<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ใบเสร็จ</title>
    <link rel="stylesheet" href="main.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <div class="head-box"> <!--กล่องใหญ่-->
        <div id="sidemenuacc"></div> <!--กล่อง sidebar-->
        <div class="main-project"><!--กล่อง main-->
            <div class="navbar">
                <div style="width: 100%;height: 100%; padding: 24px;">
                    <div style=" width: 100%; height: 100%;display: flex;justify-content: space-between; ">
                        <div style="width: 530px; height: 40px; padding: 6.5px 0;">
                            <div class="nav-menu">
                                <div style="background-color: #FFFFFF; display: flex;width: 400px; border-radius: 32px;height: 100%;display: flex;align-items: center;justify-content: center; gap: 8px;">
                                <div class="text-nav">หน้าหลัก</div>
                                <img src="picture/arrow-right-nav.png" style="width: 12px;height: 12px;">
                                <div class="text-nav">การเงิน</div>
                                <img src="picture/arrow-right-nav.png" style="width: 12px;height: 12px;">
                                <div class="text-nav">รับเงิน</div>
                                <img src="picture/arrow-right-nav.png" style="width: 12px;height: 12px;">
                                <div class="text-nav">รับชำระหนี้</div>
                                <img src="picture/arrow-right-nav.png" style="width: 12px;height: 12px;">
                                <div class="text-nav">สร้างใบเสร็จ</div>
                                </div>
                                <div style="width: 135px;display: flex;justify-content: center;align-items: center;">
                                    <div style="color: #FFFFFF; font-weight: 700; font-size: 14px;">RE-2025011300001</div>
                                </div>
                            </div>
                        </div>
                        <div style=" width: 30%; height: 100%; display: flex; justify-content: end; gap: 8px;">
                            <div class="nav-pic-right" id="printf" onclick="goToPaperDepositReceipt()"><img src="picture/print.png"  class="nav-pic"></div>
                            <div class="nav-pic-right" id="download" onclick="downloadQuotationPDF()"><img src="picture/upload.png"  class="nav-pic"></div>
                            <div class="nav-pic-right"><img src="picture/send.png"  class="nav-pic"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="head-work">
                <div class="work">
                    <div class="deposit-receipt-box">
                        <div class="deposit-receipt-head-box">
                            <div class="deposit-receipt-head-box-title"id="quotationTitle">ใบเสร็จ</div>
                            <div class="deposit-receipt-head-box-title" id="historyTitle" style="display: none;"></div>
                              <div class="deposit-receipt-head-box-title"  id="approveTitle">อนุมัติใบจ่ายเงิน</div>
                            <!-- <div class="deposit-receipt-head-box-title">อนุมัติใบเสร็จ</div> ถ้ากดปุ่มอนุมัติหัวข้อจะเปลี่ยนเป็นอนุมัติใบเสร็จ -->
                            <div class="deposit-receipt-box-mini">
                                <div class="deposit-receipt-box-mini-in">
                                    <div class="deposit-receipt-box-mini-deposit">เลขที่ใบเสร็จ</div>
                                    <div class="deposit-receipt-box-mini-number">RE-2025011300001</div>
                                </div>
                                <div class="deposit-receipt-box-mini-in-back">
                                    <div class="deposit-receipt-box-mini-deposit-in">มูลค่าสุทธิ (บาท)</div>
                                    <div class="deposit-receipt-box-mini-number-in">21,100.00</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="container">
                        <div class="tabs">
                            <input type="radio" id="radio-1" name="tabs" checked />
                            <label class="tab" for="radio-1">ข้อมูลเอกสาร<span></span></label>
                            <input type="radio" id="radio-2" name="tabs" />
                            <label class="tab" for="radio-2">ข้อมูลการชำระ</label>
                            <input type="radio" id="radio-3" name="tabs" />
                            <label class="tab" for="radio-3">ข้อมูลประวัติ</label>
                            <span class="glider"></span>
                        </div>
                        <div id="pagepreviewdeposit1" class="tab-content-new active">
                            <div class="head-second">
                                <div class="head-second-box">
                                    <div class="second-box-in">
                                        <div class="document-title">ข้อมูลลูกค้า</div>
                                        <div class="data-box">
                                            <div class="data-box-1">
                                                <div class="data-customer-box">
                                                    <div class="text-thin">ชื่อลูกค้า</div>
                                                    <div class="text-bold" id="customerNameDisplay">ลูกค้าทดสอบ1</div>
                                                </div>
                                                <div class="address-customer-box">
                                                    <div class="text-thin">ที่อยู่ลูกค้า</div>
                                                    <div class="text-bold"id="customerAddressDisplay">90 อาคารซีดับเบิ้ลยู ทาวเวอร์ ชั้น 3 ห้อง 310
                                                        ถนนรัชดาภิเษก แขวงห้วยขวาง เขตห้วยขวาง กรุงเทพมหานคร 10310</div>
                                                </div>
                                                <div class="email-customer-box">
                                                    <div class="text-thin">อีเมล</div>
                                                    <div class="text-bold"id="customerGmailDisplay">Test_customer@test.co.th1</div>
                                                </div>
                                                <div class="office-customer-box">
                                                <div class="text-thin">สำนักงาน / สาขา</div>
                                                <div class="office-customer-two-box">
                                                <div class="text-bold">สาขาย่อย:</div>
                                                 <div class="text-bold" id="customerBranchCodeDisplay">nt1234</div>
                                                <div class="text-bold" id="customerBranchNameDisplay">สาขาทดสอบ1</div>
                                                </div>
                                            </div>
                                            </div>
                                            <div class="cover-data-box-2-3">
                                                <div class="data-box-2">
                                                    <div class="password-customer-box">
                                                        <div class="text-thin">รหัสลูกค้า</div>
                                                        <div class="text-bold" id="customerCodeDisplay" >BB-0000000000</div>
                                                    </div>
                                                    <div class="address-office-box">
                                                        <div class="text-thin">ที่ตั้งธุรกิจ</div>
                                                        <div class="text-bold">ไทย</div>
                                                    </div>
                                                    <div class="refer-data-box-save-the-receipt">
                                                        <div class="text-thin">หมายเหตุ</div>
                                                        <div class="text-bold" id="customerNoteDisplay">วางบิลทุกวันที่ 15 และ 30 ของเดือน</div>
                                                    </div>
                                                </div>
                                                <div class="data-box-3">
                                                    <div class="phone-number-box">
                                                        <div class="text-thin">เบอร์โทร</div>
                                                        <div class="text-bold" id="customerPhoneDisplay">02-1234-0000</div>
                                                    </div>
                                                    <div class="contact-customer">
                                                        <div class="text-thin">ชื่อผู้ติดต่อ</div>
                                                        <div class="text-bold"id="customerContactNameDisplay">ผู้ติดต่อทดสอบ1</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="head-three-kk">
                                        <div class="document-title">ข้อมูลเอกสาร</div>
                                        <div class="date-due-date-box">
                                            <div class="date-box-in"> 
                                                <div class="text-thin">แผนก</div>
                                                <div class="text-bold"id="customerDepartmentDisplay">UXUI Designer</div>
                                            </div>
                                            <div class="due-date-box">
                                                <div class="text-thin">วันที่</div>
                                                <div class="text-bold" id="customerDateDisplay">19/01/2025</div>
                                            </div>
                                        </div>
                                        <div class="data-price-tax-currency-box">
                                            <div class="data-price-tax-box">
                                                <div class="text-thin">วันที่ชำระ</div>
                                                <div class="text-bold"id="customerPaymentDateDisplay">27/01/2025</div>
                                            </div>
                                            <div class="cuurrency-box">
                                                <div class="text-thin">พนักงานขาย</div>
                                                <div class="text-bold" id="customerSalespersonDisplay">พนักงาน01</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="head-four">
                                <div class="list-bar-box">
                                    <div class="list-bar-title">
                                        รายการบิลรับชำระ
                                    </div>
                                    <div class="list-bar-text">
                                        สินค้า/บริการ
                                    </div>
                                    <div class="list-bar-box-in">
                                        <div class="list-bar-data-box">
                                            <div class="list-bar-number">
                                                <div class="order-list-box">
                                                    <div class="data5-table">
                                                        <table class="data-table-preview-deposit9">
                                                            <thead>
                                                                <tr>
                                                                    <th>ลำดับ</th>
                                                                    <th>เลขใบกำกับ</th>
                                                                    <th>วันที่</th>
                                                                    <th>ใบวางบิล</th>
                                                                    <th>ราคารวม</th>
                                                                    <th>วันที่ครบกำหนด</th>
                                                                    <th>ยอดชำระ</th>
                                                                    <th>ยอดคงค้าง</th>
                                                                    <th></th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr class="data-row">
                                                                    <td>1</td>
                                                                    <td>IV-202501130001</td>
                                                                    <td>30/01/2025</td>
                                                                    <td>IV-202501130001</td>
                                                                    <td>43,100.00</td>
                                                                    <td>27/01/2025</td>
                                                                    <td>20,000.00</td>
                                                                    <td>23,100.00</td>
                                                                    <td></td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                    <div class="amount-money-box-kk">
                                                        <div class="amount-money-box">
                                                            <div class="amount-box-in-one">
                                                                <div class="amount-box-in-text-number">
                                                                    <div class="amount-box-in-text">จำนวนเงิน
                                                                    </div>
                                                                    <div class="amount-money-box-in-number-box">
                                                                        <div class="amount-money-box-in-number">
                                                                            20,000.00</div>
                                                                        <div class="amount-money-box-in-number-bart">บาท
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!-- <div class="amount-box-in-text-number">
                                                                <div class="amount-box-in-text">หักส่วนลด</div>
                                                                <div class="amount-money-box-in-number-box">
                                                                    <div class="amount-money-box-in-number">
                                                                        100.00</div>
                                                                    <div class="amount-money-box-in-number-bart">บาท
                                                                    </div>
                                                                </div>
                                                            </div> -->
                                                                <div class="amount-money-box-in-tax-seven">
                                                                    <div class="checkbox-box-disableb">
                                                                        <div class="checkbox-box-1-force-seven">
                                                                            <input type="checkbox" name="visits"
                                                                                id="list-tax"
                                                                                class="checkbox-input-disableb" checked
                                                                                disabled>
                                                                            <label for="list-tax"></label>
                                                                        </div>
                                                                        <div class="seven-percent-box">
                                                                            <div class="checkbox-box-1-text-seven">
                                                                                รายการภาษี
                                                                            </div>
                                                                            <div class="seven-percent"> 7%</div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="amount-money-box-in-tax-number-box">
                                                                        <div class="amount-money-box-in-tax-number">
                                                                            1,400.00</div>
                                                                        <div
                                                                            class="amount-money-box-in-tax-number-bart">
                                                                            บาท
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="amount-money-box-in-tax-seven-drop">
                                                                    <div class="checkbox-box-disableb-drop">
                                                                        <div class="checkbox-box-1-force-seven-drop">
                                                                            <input type="checkbox" name="visits"
                                                                                id="list-tax"
                                                                                class="checkbox-input-disableb" checked
                                                                                disabled>
                                                                            <label for="list-tax"></label>
                                                                        </div>
                                                                        <div class="seven-percent-box">
                                                                            <div class="checkbox-box-1-text-seven">
                                                                                ภาษีถูกหัก ณ ที่จ่าย 1.5%
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="amount-money-box-in-tax-number-box">
                                                                        <div class="amount-money-box-in-tax-number">
                                                                            300.00</div>
                                                                        <div
                                                                            class="amount-money-box-in-tax-number-bart">
                                                                            บาท
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="sell-all-box">
                                                                <div class="sell-all-box-in-text-number">
                                                                    <div class="sell-all-box-in-text">จำนวนเงินทั้งสิ้น
                                                                    </div>
                                                                    <div class="sell-all-box-in-box">
                                                                        <div class="sell-all-box-in-number">21,100.00
                                                                        </div>
                                                                        <div class="sell-all-box-in-number-bart">บาท
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="cover-signature">
                                <div class="signature-eltc-box">
                                    <div class="signature-eltc-box-in-one">
                                        <div class="checkbox-box-1">
                                            <input type="checkbox" name="visits" id="list-tax-1"
                                                class="checkbox-input-1" disabled>
                                            <label for="list-tax-1"></label>
                                            <div class="checkbox-box-1-text">
                                                ลายเซ็นต์อิเล็กทรอนิกและตารายาง
                                            </div>
                                        </div>
                                        <div class=" footnote-box">
                                            <div class="footnote-text-title">หมายเหตุ</div>
                                            <div class="footnote-text" id="customerNoteunderDisplay">ฟรีค่าจัดส่ง พร้อมอุปกรณ์ติดตั้ง</div>
                                        </div>
                                    </div>
                                    <div class="signature-eltc-box-in-two">
                                        <div class="signature-eltc-box-in-two-in">
                                            <div class="signature-eltc-text-title">ผู้จัดทำ</div>
                                            <div class="signature-eltc-text" id="name-Creator">ธิติรัตน์ สตาปรณ์ศิริ</div>
                                        </div>
                                        <div class="checkbox-container">
                                            <div class="checkbox-item">
                                                <input type="checkbox" name="visits" id="not-show-name"
                                                    class="my-checkbox-input">
                                                <label for="not-show-name">ไม่แสดงชื่อผู้จัดทำ</label>
                                            </div>
                                            <div class="checkbox-item">
                                                <input type="checkbox" name="signature" id="signature-option"
                                                    class="my-checkbox-input" checked>
                                                <label for="signature-option">ลายเซ็นต์อิเล็กทรอนิก</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="attach-file">
                                    <div class="attach-file-text-title">แนบไฟล์</div>
                                    <div class="attach-file-box">
                                        <div class="attach-file-box-pdf">
                                            <div class="attach-file-box-pdf-img">
                                                <img src="picture/file-pdf-fill.png" alt="PDF" />
                                            </div>
                                            <div class="document-pdf">document1</div>
                                            <div class="mb-pdf">(32 MB)</div>
                                        </div>
                                        <div class="attach-file-box-word">
                                            <div class="attach-file-box-word-img">
                                                <img src="picture/file-word-fill.png" alt="word" />
                                            </div>
                                            <div class="document-word">document2</div>
                                            <div class="mb-word">(10 MB)</div>
                                        </div>
                                        <div class="attach-file-box-image">
                                            <div class="attach-file-box-image-img">
                                                <img src="picture/file-image-fill.png" alt="image" />
                                            </div>
                                            <div class="document-image">document3</div>
                                            <div class="mb-image">(24 MB)</div>
                                        </div>
                                        <div class="attach-file-box-subtract">
                                            <div class="attach-file-box-subtract-img">
                                                <img src="picture/xfile.png" alt="subtract" />
                                            </div>
                                            <div class="document-subtract">document4</div>
                                            <div class="mb-subtract">(39 MB)</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- กล่องใหญ่ของ3ปุ่ม ถ้ากดปุ่มอนุมัติจะขึ้นแค่ปุ่มกลับไปหน้าหลักและจะเปลี่ยนหัวข้อเป็นอนุมัติใบเสร้จ-->
                            <div class="tree-button">
                                <div class="cover-box-home-edit-approve">
                                    <!-- กล่องกลับไปหน้าหลัก -->
                                    <div class="Homepage-button" id="btnHome">
                                        <a href="create-deposit-receipt-table.html"
                                            class="word-Homepage-button">กลับไปหน้าหลัก</a>
                                    </div>
                                    <!-- กล่องแก้ไข -->
                                    <div class="edit-button"id="btnEdit">
                                        <a href="pay-off-deposit.html"><div class="word-edit-button">แก้ไข</div></a>
                                    </div>
                                    <!-- กล่องอนุมัติ -->
                                    <div class="approve-button" id="btnApprove">
                                        <a href="#" class="word-appvrove-button">อนุมัติ</a>     
                                    </div>
                                     <div class="Homepage-button"  id="goBack" style="display:none;"> <!-- กล่องกลับไปหน้าหลัก -->
                                    <a href="#"  class="word-Homepage-button">กลับไปหน้าหลัก</a>
                                </div>
                                </div>
                            </div>
                        </div>
                        <!--ข้อมูลการหักเงินมัดจำ-->
                        <!--ข้อมูลการหักเงินมัดจำ-->
                        <div id="pagepreviewdeposit2" class="tab-content-new">
                            <div class="box-deposittree">
                                <div class="deposittree">
                                    <div class="depo-hub">
                                        <div>
                                            <div class="depo-hub-text1">ยอดชำระตามใบกำกับ</div>
                                            <div class="word-list">สินค้า/บริการ</div><!--หัวข้อ-->
                                        </div>
                                        <div class="box-depo">
                                            <div class="depo-hub-text3">ชำระเงินแล้ว</div>
                                            <div class="depo-hub-text4">รับชำระครบเมื่อวันที่: 27/01/2025</div>
                                        </div>
                                    </div>
                                    <div class="minus-deposit01">
                                        <div class="deposit-top">
                                            <div class="deposit-payment">มูลค่ารวมภาษี</div>
                                            <div class="deposit-gap">
                                                <div class="money">46,117.00</div>
                                                <div class="baht">บาท</div>
                                            </div>
                                        </div>
                                        <div class="deposit-normal">
                                            <div class="deposit-payment">ภาษีถูกหัก ณ ที่จ่าย 1.5%</div>
                                            <div class="deposit-gap">
                                                <div class="money">300.00</div>
                                                <div class="baht">บาท</div>
                                            </div>
                                        </div>
                                        <div class="deposit-normal">
                                            <div class="deposit-payment">ยอดคงค้าง</div>
                                            <div class="deposit-gap">
                                                <div class="money">0000.00</div>
                                                <div class="baht">บาท</div>
                                            </div>
                                        </div>
                                        <div class="deposit-buttom">
                                            <div class="deposit-payment">ยอดชำระจริง</div>
                                            <div class="deposit-gap">
                                                <div class="money">46,417.00</div>
                                                <div class="baht">บาท</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="box-deposittree">
                                <div class="deposittree">
                                    <div class="depo-hub">
                                        <div>
                                            <div class="depo-hub-text1">รายการรับชำระ</div>
                                            <div class="depo-hub-text2">สินค้า/บริการ</div>
                                        </div>
                                    </div>
                                    <div class="bank-box">
                                        <div class="bank-box-in">
                                            <div class="choice-sell-tilte">ช่องทางการชำระเงิน</div>
                                            <div class="bank-title">ธนาคาร</div>
                                            <div class="bank-box-name">
                                                <div class="bank-box-name-page-two">
                                                </div>
                                                <div class="bank-box-name-page-two-in">
                                                    <div class="bank-name-text">ธ.ไทยพาณิชย์ ออมทรัพย์ -</div>&nbsp;
                                                    <div class="number-bank-pagetwo">xxx-x-x0004-x Test company</div>
                                                </div>
                                            </div>
                                            <div class="time-box">
                                                <div>
                                                    <div class="time-text">วันที่ชำระ</div>
                                                    <div class="time-number-text">27/01/2025</div>
                                                </div>
                                                <div>
                                                    <div>
                                                        <div class="time-text">เวลา</div>
                                                        <div class="time-number-text">13:45</div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="time-text">แนบรูปสลิป</div>
                                            <div class="document-page-box">
                                                <div class="document-page-two">Slip1.jpg</div>
                                                <div class="mb-page-two">(32 MB)</div>
                                            </div>
                                            <div>
                                                <div class="Attach-slip">แนบรูปสลิป</div>
                                                <div class="upload-file-box">
                                                    <div class="openPopupBtnupload">
                                                        <div class="upload-file-box-in">
                                                            <img src="picture/save.png" class="img-save">
                                                            อัพโหลดไฟล์
                                                        </div>
                                                    </div>
                                                </div>
                                                <input type="file" id="upload-slip" class="hidden-input-file"
                                                    accept="image/jpeg,application/pdf">
                                                <div style="display: flex; margin-top: 8px;gap: 8px;">
                                                    <div id="file-name-display" class="selected-file-info"></div>
                                                    <div id="file-size-display"></div>
                                                    <div class="additional-images">
                                                        <img src="picture/eye.png" id="image1" alt="รูปภาพเพิ่มเติม 1">
                                                        <img src="picture/bin.png" id="image2" alt="รูปภาพเพิ่มเติม 2">
                                                    </div>
                                                </div>
                                                <div id="after-selection-message" class="selected-file-info"></div>
                                                <div class="file-detail">(ขนาดไฟล์เอกสาร pdf, jpg ไม่เกิน 40 MB)</div>
                                            </div>
                                        </div>
                                        <div class="minus-deposit-sum-box">
                                            <div class="minus-deposit-sum">
                                                <div class="deposit-normal1">
                                                    <div class="deposit-payment">ภาษีถูกหัก ณ ที่จ่าย 1.5%</div>
                                                    <div class="deposit-gap">
                                                        <div class="money">300.00</div>
                                                        <div class="baht">บาท</div>
                                                    </div>
                                                </div>
                                                <div class="deposit-normal">
                                                    <div class="deposit-payment">จำนวนเงินรวมทั้งสิ้น</div>
                                                    <div class="deposit-gap">
                                                        <div class="money">46,417.00</div>
                                                        <div class="baht">บาท</div>
                                                    </div>
                                                </div>
                                                <div class="sell-all-box">
                                                    <div class="sell-all-box-in-text-number">
                                                        <div class="sell-all-box-in-text">
                                                            ชำระรวมทั้งสิ้น</div>
                                                        <div class="sell-all-box-in-box">
                                                            <div class="sell-all-box-in-number">
                                                                46,417.00</div>
                                                            <div class="sell-all-box-in-number-bart">บาท
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="back-save-box">
                                    <div class="back-save-box-box">
                                        <a href="create-deposit-receipt-table.html"><div class="back-box-in-1">
                                            กลับหน้าหลัก
                                        </div></a>
                                        <a href="create-deposit-receipt-table.html"><div class="save-box-in">
                                            บันทึก
                                        </div></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--ข้อมูลประวัติ-->
                        <div id="pagepreviewdeposit3" class="tab-content-new">
                            <div class="page-three-box">
                                <div class="page-three-box-in">
                                    <ul class="timeline">
                                        <li>
                                            <div class="timestamp">
                                                <div class="text-date">27/01/25</div>
                                                <div class="text-time">16:09:12</div>
                                            </div>
                                            <div class="dot-line">
                                                <div class="dot active"></div>
                                                <div class="line"></div>
                                            </div>
                                            <div class="content">
                                                <div class="user-box-in">
                                                    <div class="user-title">User test 02</div>
                                                    <div class="save-test">อนุมัติใบรับเงินมัดจำ</div>
                                                </div>
                                                <div class="day-box">
                                                    <div class="note-text">หมายเหตุ: รอเอกสารเพิ่มเติมจากลูกค้า</div>
                                                </div>
                                            </div>
                                        </li>
                                        <li>
                                            <div class="timestamp">
                                                <div class="text-date">17/01/25</div>
                                                <div class="text-time">11:09:14</div>
                                            </div>
                                            <div class="dot-line">
                                                <div class="dot"></div>
                                                <div class="line"></div>
                                            </div>
                                            <div class="content">
                                                <div class="user-box-in">
                                                    <div class="user-title">User test 01</div>
                                                    <div class="save-test">บันทึกใบเสนอราคา</div>
                                                </div>
                                            </div>
                                        </li>
                                        <li>
                                            <div class="timestamp">
                                                <div class="text-date">12/01/25</div>
                                                <div class="text-time">10:12:34</div>
                                            </div>
                                            <div class="dot-line">
                                                <div class="dot"></div>
                                                <div class="line"></div>
                                            </div>
                                            <div class="content">
                                                <div class="user-box-in">
                                                    <div class="user-title">User test 01</div>
                                                    <div class="save-test">ดูเอกสาร</div>
                                                </div>
                                                <div class="day-box">
                                                    <div class="note-text">หมายเหตุ: รอเอกสารเพิ่มเติมจากลูกค้า</div>
                                                </div>
                                            </div>
                                        </li>
                                        <li>
                                            <div class="timestamp">
                                                <div class="text-date">02/01/25</div>
                                                <div class="text-time">10:45:34</div>
                                            </div>
                                            <div class="dot-line">
                                                <div class="dot"></div>
                                            </div>
                                            <div class="content">
                                                <div class="user-box-in">
                                                    <div class="user-title">User test 01</div>
                                                    <div class="save-test">เริ่มสร้างใบเสนอราคา</div>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <!--ข้อมูลประวัติ-->
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--อัปโหลดไฟล์-->
    <div class="popup-container myPopupupload">
        <div class="popup-content-edit-sum-upload">
            <div style="width: 100%;">
                <div class="bold">อัปโหลดไฟล์</div>
                <div class="regular">ชื่อไฟล์และไฟล์ที่แนบมาทั้งหมด</div>
            </div>
            <div style="display: flex;">
                <div class="left-modal-upload">
                    <div class="upload-modal">อัปโหลดไฟล์</div>
                    <div class="bg-uplaod">
                        <div>
                            <div style="display: flex; justify-content: center;">
                                <div>
                                    <img src="picture/upload-gray.png" class="upload-gray">
                                </div>
                            </div>
                            <div class="upload-name">อัพโหลดไฟล์</div>
                        </div>
                    </div>
                    <div class="display-upload">(ขนาดไฟล์เอกสาร pdf, jpg, xls,
                        doc ไม่เกิน 40 MB / ไฟล์)</div>
                </div>
                <div class="right-modal-upload">
                    <div class="upload-modal">อัปโหลดไฟล์</div>
                    <div class="x-upload-16">
                        <div> <input type="text" placeholder="document3.pdf" class="code-edit-box-sum-edit-dis"></div>
                        <div class="check-x">
                            <img src="picture/check-green.png" class="upload-gray">
                            <img src="picture/x-icon.png" class="upload-gray">
                        </div>
                    </div>
                    <div class="x-upload-doc">
                        <div class="doc-upload">
                            <div class="doc-name">document1.pdf</div>
                            <div class="MB-upload">(32 MB)</div>
                        </div>
                        <div class="check-x">
                            <img src="picture/eye.png" class="upload-gray">
                            <img src="picture/pen.png" class="upload-gray">
                            <img src="picture/bin.png" class="upload-gray">
                        </div>
                    </div>
                    <div class="x-upload-doc">
                        <div class="doc-upload">
                            <div class="doc-name">image_sell01.jpg</div>
                            <div class="MB-upload">(5 MB)</div>
                        </div>
                        <div class="check-x">
                            <img src="picture/eye.png" class="upload-gray">
                            <img src="picture/pen.png" class="upload-gray">
                            <img src="picture/bin.png" class="upload-gray">
                        </div>
                    </div>
                    <div class="x-upload-doc">
                        <div class="doc-upload">
                            <div class="doc-name">document2.pdf</div>
                            <div class="MB-upload">(32 MB)</div>
                        </div>
                        <div class="check-x">
                            <img src="picture/eye.png" class="upload-gray">
                            <img src="picture/pen.png" class="upload-gray">
                            <img src="picture/bin.png" class="upload-gray">
                        </div>
                    </div>
                </div>
            </div>
            <div class="cancel-save-under">
                <div class="box-cancel-save">
                    <div class="cancel cancelPopupBtn">ยกเลิก</div>
                    <div class="save addAndHideBtn">อัปโหลด</div>
                </div>
            </div>
        </div>
    </div>
    <script src="sidebarmain.js"></script>
    <script>

let endpoint = 'http://localhost:3000';
    $(document).ready(function () {
    
        loadQuotationPreviewData()
    let isApproved = false;

    const $tabRadios = $('input[name="tabs"]');
    const $tabContents = $('.tab-content-new');

    const displaySelectedTabContent = () => {
        const selectedRadioId = $tabRadios.filter(':checked').attr('id');
        const tabNumber = selectedRadioId.split('-')[1];
        const tabIdMap = {
            '1': 'pagepreviewdeposit1',
            '2': 'pagepreviewdeposit2',
            '3': 'pagepreviewdeposit3'
        };
        $tabContents.removeClass('active');
        $(`#${tabIdMap[tabNumber]}`).addClass('active');
    };

    $tabRadios.on('change', displaySelectedTabContent);
    displaySelectedTabContent();

    // -------------------------------
    // จัดการหัวข้อแสดงผล
    // -------------------------------
    $('#quotationTitle').show();
    $('#approveTitle').hide();
    $('#historyTitle').hide();

    $('#radio-1').on('click', function () {
        if (isApproved) {
            $('#quotationTitle').hide();
            $('#historyTitle').hide();
            $('#approveTitle').show();
        } else {
            $('#quotationTitle').show();
            $('#historyTitle').hide();
            $('#approveTitle').hide();
        }
    });

    $('#radio-2').on('click', function () {
        $('#quotationTitle').hide();
        $('#approveTitle').hide();
        $('#historyTitle').text('ข้อมูลการหักเงินมัดจำ').show();
    });

    $('#radio-3').on('click', function () {
        $('#quotationTitle').hide();
        $('#approveTitle').hide();
        $('#historyTitle').text('ข้อมูลการหักเงินมัดจำ').show();
    });

    $('#btnApprove').on('click', function () {
        isApproved = true;
        $('#quotationTitle').hide();
        $('#historyTitle').hide();
        $('#approveTitle').show();
    });
});
$(document).ready(function() {
    // ซ่อนปุ่ม goBack ตอนโหลดหน้า
    $('#goBack').hide();

    // เมื่อกดปุ่ม อนุมัติ
    $('#btnApprove a').click(function(e) {
        e.preventDefault(); // กันลิงก์ไปหน้าจริง (ถ้าต้องการเปลี่ยนลิงก์แทน ให้แก้ที่นี่)

        // ซ่อน 3 ปุ่มบน
        $('#btnHome, #btnEdit, #btnApprove').hide();

        // แสดงปุ่ม goBack
        $('#goBack').show();
    });
});
$(document).ready(function() {
  // ซ่อนข้อความ "อนุมัติใบเสนอราคา" ตอนโหลดหน้า
  $('#approveTitle').hide();

  // เมื่อกดปุ่ม btnApprove
  $('#btnApprove').click(function() {
    $('#quotationTitle').hide();   // ซ่อน "ใบเสนอราคา"
    $('#approveTitle').show();     // แสดง "อนุมัติใบเสนอราคา"
  });
});
$('#goBack').click(function () {
      localStorage.setItem('hasData', 'true'); // ตั้งให้แสดงข้อมูลเมื่อย้อนกลับ
      window.location.href = 'debit-note-table.html'; // กลับไปหน้าแรก
    });
        $(document).ready(function () {
            const $openPopupBtnsUpload = $('.openPopupBtnupload');
            const $openPopupBtnsPenView = $('.openPopupBtnpenview');
            const $openPopupBtnsView = $('.openPopupBtnview');
            const $openPopupBtnsAdd = $('.openPopupBtnadd');
            const $openPopupBtnsEditPen = $('.openPopupBtneditpen');
            const $openPopupBtnsDeposit = $('.openPopupBtndeposit');
            const $openPopupBtnsAddDate = $('.openPopupBtnadddate');
            const $openPopupBtnsViewDate = $('.openPopupBtnviewdate');
            const $openPopupBtnsAddSum = $('.openPopupBtnaddsum');
            const $openPopupBtnsSalesOrder = $('.openPopupBtnsalesorder');
            const $openPopupBtnsAddDeposit = $('.openPopupBtndeopsit');
            const $openPopupBtnsSelectReceive = $('.openPopupBtnselectreceive');
            const $openPopupBtnsSelectBill = $('.openPopupBtnselectbill');
            const $openPopupBtnsTableSum = $('.openPopupBtntablesum');
            const $openPopupBtnsTableBillingSlip = $('.openPopupBtnTableBillingSlip');
            const $openPopupBtnsViewInvoice = $('.openPopupBtnViewInvoice');
            const $myPopupsUpload = $('.myPopupupload');
            const $myPopupsPenView = $('.myPopuppenview');
            const $myPopupsView = $('.myPopupview');
            const $myPopupsAdd = $('.myPopupadd');
            const $myPopupsEditPen = $('.myPopupeditpen');
            const $myPopupsDeposit = $('.myPopupdeposit');
            const $myPopupsAddDate = $('.myPopupadddate');
            const $myPopupsViewDate = $('.myPopupviewdate');
            const $myPopupsAddSum = $('.myPopupaddsum');
            const $myPopupsSalesOrder = $('.myPopupsalesorder');
            const $myPopupsAddDeposit = $('.myPopupadddeopsit');
            const $myPopupsSelectReceive = $('.myPopupselectreceive');
            const $myPopupsSelectBill = $('.myPopupselectbill');
            const $myPopupsTableSum = $('.myPopuptablesum');
            const $myPopupsTableBillingSlip = $('.myPopupsTableBillingSlip');
            const $myPopupsViewInvoice = $('.myPopupsviewinvoice');
            const $cancelPopupBtns = $('.cancelPopupBtn');
            const $addAndHideBtns = $('.addAndHideBtn');
            const $cancelPopupBtns2 = $('.cancelPopupBtn2');
            const $addAndHideBtns2 = $('.addAndHideBtn2');
            const $cancelPopupBtns3 = $('.cancelPopupBtn3');
            const $addAndHideBtns3 = $('.addAndHideBtn3');
            const $cancelPopupBtns4 = $('.cancelPopupBtn4');
            const $addAndHideBtns4 = $('.addAndHideBtn4');
            const $cancelPopupBtns5 = $('.cancelPopupBtn5');
            const $addAndHideBtns5 = $('.addAndHideBtn5');
            const $cancelPopupBtns6 = $('.cancelPopupBtn6');
            const $addAndHideBtns6 = $('.addAndHideBtn6');
            const $cancelPopupBtns7 = $('.cancelPopupBtn7');
            const $addAndHideBtns7 = $('.addAndHideBtn7');
            const $cancelPopupBtns8 = $('.cancelPopupBtn8');
            const $addAndHideBtns8 = $('.addAndHideBtn8');
            const $cancelPopupBtns9 = $('.cancelPopupBtn9');
            const $addAndHideBtns9 = $('.addAndHideBtn9');
            const $cancelPopupBtns10 = $('.cancelPopupBtn10');
            const $addAndHideBtns10 = $('.addAndHideBtn10');
            const $cancelPopupBtns11 = $('.cancelPopupBtn11');
            const $addAndHideBtns11 = $('.addAndHideBtn11');
            const $hidePopupAdd11 = $('.hidePopupadd11');
            const $cancelPopupBtns12 = $('.cancelPopupBtn12');
            const $addAndHideBtns12 = $('.addAndHideBtn12');
            const $hidePopupAdd12 = $('.hidePopupadd12');
            const $cancelPopupBtns13 = $('.cancelPopupBtn13');
            const $addAndHideBtns13 = $('.addAndHideBtn13');
            const $hidePopupAdd13 = $('.hidePopupadd13');
            const $cancelPopupBtns14 = $('.cancelPopupBtn14');
            const $addAndHideBtns14 = $('.addAndHideBtn14');
            const $hidePopupAdd14 = $('.hidePopupadd14');
            const $cancelPopupBtnsTableBillingSlip = $('.cancelPopupBtnTableBillingSlip');
            const $addAndHideBtnsTableBillingSlip = $('.addAndHideBtnTableBillingSlip');
            const $hidePopupAddTableBillingSlip = $('.hidePopupAddTableBillingSlip');
            const $cancelPopupBtnsViewInvoice = $('.cancelPopupBtnViewInvoice');
            const $addAndHideBtnsViewInvoice = $('.addAndHideBtnViewInvoice');
            const $hidePopupAddViewInvoice = $('.hidePopupAddViewInvoice');
            const $sideuploads = $('.sideupload');
            const $sideuploadCancelBtns = $('.sideuploadCancelBtn');
            const $sideuploadSaveBtns = $('.sideuploadSaveBtn');
            const $uploadFileBtns = $('.uploadFileBtn');
            const $openEditBtns = $('.openedit');
            const $sideadds = $('.sideadd');
            const $sideaddCancelBtns = $('.sideaddCancelBtn');
            const $sideaddSaveBtns = $('.sideaddSaveBtn');
            const $sidetables = $('.sidetable');
            const $sidetableCancelBtns = $('.sidetableCancelBtn');
            const $sidetableSaveBtns = $('.sidetableSaveBtn');
            const $newBtns1 = $('.newButton1');
            const $newBtns2 = $('.newButton2');
            const $newBtns3 = $('.newButton3');
            const $newBtns4 = $('.newButton4');
            const $newBtns5 = $('.newButton5');
            const searchItemsLong = $('.data-search-long');
            const searchItemsShort = $('.data-search');
            const TRANSITION_DURATION = 150;
            let currentMainPopup = null;
            function showPopup($popupElement) {
                $popupElement.css('display', 'flex');
                setTimeout(() => {
                    $popupElement.addClass('show');
                    $('body').addClass('no-scroll');
                }, 10);
            }
            function hidePopup($popupElement) {
                $popupElement.removeClass('show');
                setTimeout(() => {
                    if (!$('.popup.show').length && !$('.sideupload.show').length && !$('.sideadd.show').length && !$('.sidetable.show').length) {
                        $('body').removeClass('no-scroll');
                    }
                    if (!$popupElement.hasClass('show')) {
                        $popupElement.css('display', 'none');
                    }
                }, TRANSITION_DURATION);
            }
            function hideSideuploadAndShowMainPopup() {
                hidePopup($sideuploads);
                setTimeout(() => {
                    if (currentMainPopup) {
                        showPopup(currentMainPopup);
                        currentMainPopup = null;
                    }
                }, TRANSITION_DURATION);
            }
            function hideSideaddAndShowMainPopup($mainPopupElement) {
                hidePopup($sideadds);
                setTimeout(() => {
                    showPopup($mainPopupElement);
                }, TRANSITION_DURATION);
            }
            function hideSidetableAndShowMainPopup($mainPopupElement) {
                hidePopup($sidetables);
                setTimeout(() => {
                    showPopup($mainPopupElement);
                }, TRANSITION_DURATION);
            }
            function setupRowSelection(items) {
                items.each(function () {
                    const item = $(this);
                    item.on('click', function () {
                        items.each(function () {
                            const currentItem = $(this);
                            currentItem.removeClass('selected');
                            const eyeImg = currentItem.find('.eye-search');
                            if (eyeImg.length) {
                                eyeImg.attr('src', 'picture/eye.png');
                            }
                        });
                        item.addClass('selected');
                        const eyeImgSelected = item.find('.eye-search');
                        if (eyeImgSelected.length) {
                            eyeImgSelected.attr('src', 'picture/eye-white.png');
                        }
                        console.log('Item clicked and selected:', item.attr('class'));
                    });
                });
            }
            setupRowSelection(searchItemsLong);
            setupRowSelection(searchItemsShort);
            $openPopupBtnsUpload.on('click', function () { showPopup($myPopupsUpload); console.log(`องค์ประกอบ "เปิด" สำหรับ .myPopupupload ถูกคลิก!`); });
            $openPopupBtnsPenView.on('click', function () { showPopup($myPopupsPenView); console.log(`องค์ประกอบ "เปิด" สำหรับ .myPopuppenview ถูกคลิก!`); });
            $openPopupBtnsView.on('click', function () { showPopup($myPopupsView); console.log(`องค์ประกอบ "เปิด" สำหรับ .myPopupview ถูกคลิก!`); });
            $openPopupBtnsAdd.on('click', function () { showPopup($myPopupsAdd); console.log(`องค์ประกอบ "เปิด" สำหรับ .myPopupadd ถูกคลิก!`); });
            $openPopupBtnsEditPen.on('click', function () { showPopup($myPopupsEditPen); console.log(`องค์ประกอบ "เปิด" สำหรับ .myPopupeditpen ถูกคลิก!`); });
            $openPopupBtnsDeposit.on('click', function () { showPopup($myPopupsDeposit); console.log(`องค์ประกอบ "เปิด" สำหรับ .myPopupdeposit ถูกคลิก!`); });
            $openPopupBtnsAddDate.on('click', function () { showPopup($myPopupsAddDate); console.log(`องค์ประกอบ "เปิด" สำหรับ .myPopupadddate ถูกคลิก!`); });
            $openPopupBtnsViewDate.on('click', function () { showPopup($myPopupsViewDate); console.log(`องค์ประกอบ "เปิด" สำหรับ .myPopupviewdate ถูกคลิก!`); });
            $openPopupBtnsAddSum.on('click', function () { showPopup($myPopupsAddSum); console.log(`องค์ประกอบ "เปิด" สำหรับ .myPopupaddsum ถูกคลิก!`); });
            $openPopupBtnsSalesOrder.on('click', function () { showPopup($myPopupsSalesOrder); console.log(`องค์ประกอบ "เปิด" สำหรับ .myPopupsalesorder ถูกคลิก!`); });
            $openPopupBtnsAddDeposit.on('click', function () { showPopup($myPopupsAddDeposit); console.log(`องค์ประกอบ "เปิด" สำหรับ .myPopupadddeopsit ถูกคลิก!`); });
            $openPopupBtnsSelectReceive.on('click', function () { showPopup($myPopupsSelectReceive); console.log(`องค์ประกอบ "เปิด" สำหรับ .myPopupselectreceive ถูกคลิก!`); });
            $openPopupBtnsSelectBill.on('click', function () { showPopup($myPopupsSelectBill); console.log(`องค์ประกอบ "เปิด" สำหรับ .myPopupselectbill ถูกคลิก!`); });
            $openPopupBtnsTableSum.on('click', function () { showPopup($myPopupsTableSum); console.log(`องค์ประกอบ "เปิด" สำหรับ .myPopuptablesum ถูกคลิก!`); });
            $openPopupBtnsTableBillingSlip.on('click', function () { showPopup($myPopupsTableBillingSlip); console.log(`องค์ประกอบ "เปิด" สำหรับ .myPopupsTableBillingSlip ถูกคลิก!`); });
            $openPopupBtnsViewInvoice.on('click', function () { showPopup($myPopupsViewInvoice); console.log(`องค์ประกอบ "เปิด" สำหรับ .myPopupsviewinvoice ถูกคลิก!`); });
            $cancelPopupBtns.on('click', function () { hidePopup($myPopupsUpload); console.log(`องค์ประกอบ "ยกเลิก" สำหรับ .myPopupupload ถูกคลิก!`); });
            $cancelPopupBtns2.on('click', function () { hidePopup($myPopupsPenView); console.log(`องค์ประกอบ "ยกเลิก" สำหรับ .myPopuppenview ถูกคลิก!`); });
            $cancelPopupBtns3.on('click', function () { hidePopup($myPopupsView); console.log(`องค์ประกอบ "ยกเลิก" สำหรับ .myPopupview ถูกคลิก!`); });
            $cancelPopupBtns4.on('click', function () { hidePopup($myPopupsAdd); console.log(`องค์ประกอบ "ยกเลิก" สำหรับ .myPopupadd ถูกคลิก!`); });
            $cancelPopupBtns5.on('click', function () { hidePopup($myPopupsEditPen); console.log(`องค์ประกอบ "ยกเลิก" สำหรับ .myPopupeditpen ถูกคลิก!`); });
            $cancelPopupBtns6.on('click', function () { hidePopup($myPopupsDeposit); console.log(`องค์ประกอบ "ยกเลิก" สำหรับ .myPopupdeposit ถูกคลิก!`); });
            $cancelPopupBtns7.on('click', function () { hidePopup($myPopupsAddDate); console.log(`องค์ประกอบ "ยกเลิก" สำหรับ .myPopupadddate ถูกคลิก!`); });
            $cancelPopupBtns8.on('click', function () { hidePopup($myPopupsViewDate); console.log(`องค์ประกอบ "ยกเลิก" สำหรับ .myPopupviewdate ถูกคลิก!`); });
            $cancelPopupBtns9.on('click', function () { hidePopup($myPopupsAddSum); console.log(`องค์ประกอบ "ยกเลิก" สำหรับ .myPopupaddsum ถูกคลิก!`); });
            $cancelPopupBtns10.on('click', function () { hidePopup($myPopupsSalesOrder); console.log(`องค์ประกอบ "ยกเลิก" สำหรับ .myPopupsalesorder ถูกคลิก!`); });
            $cancelPopupBtns11.on('click', function () { hidePopup($myPopupsAddDeposit); console.log(`องค์ประกอบ "ยกเลิก" สำหรับ .myPopupadddeopsit ถูกคลิก!`); });
            $cancelPopupBtns12.on('click', function () { hidePopup($myPopupsSelectReceive); console.log(`องค์ประกอบ "ยกเลิก" สำหรับ .myPopupselectreceive ถูกคลิก!`); });
            $cancelPopupBtns13.on('click', function () { hidePopup($myPopupsSelectBill); console.log(`องค์ประกอบ "ยกเลิก" สำหรับ .myPopupselectbill ถูกคลิก!`); });
            $cancelPopupBtns14.on('click', function () { hidePopup($myPopupsTableSum); console.log(`องค์ประกอบ "ยกเลิก" สำหรับ .myPopuptablesum ถูกคลิก!`); });
            $cancelPopupBtnsTableBillingSlip.on('click', function () { hidePopup($myPopupsTableBillingSlip); console.log(`องค์ประกอบ "ยกเลิก" สำหรับ .myPopupsTableBillingSlip ถูกคลิก!`); });
            $cancelPopupBtnsViewInvoice.on('click', function () { hidePopup($myPopupsViewInvoice); console.log(`องค์ประกอบ "ยกเลิก" สำหรับ .myPopupsviewinvoice ถูกคลิก!`); });
            $addAndHideBtns.on('click', function () {
                hidePopup($myPopupsUpload);
                setTimeout(() => {
                    currentMainPopup = $myPopupsUpload;
                    showPopup($sideuploads);
                }, TRANSITION_DURATION);
                console.log('Div "เพิ่ม" สำหรับ .myPopupupload ถูกคลิก! .sideupload แสดง.');
            });
            $addAndHideBtns4.on('click', function () {
                hidePopup($myPopupsAdd);
                setTimeout(() => {
                    currentMainPopup = $myPopupsAdd;
                    showPopup($sideadds);
                }, TRANSITION_DURATION);
                console.log('Div "เพิ่ม" สำหรับ .myPopupadd ถูกคลิก! .sideadd แสดง.');
            });
            $addAndHideBtns11.on('click', function () {
                hidePopup($myPopupsAddDeposit);
                setTimeout(() => {
                    currentMainPopup = $myPopupsAddDeposit;
                    showPopup($sidetables);
                }, TRANSITION_DURATION);
                console.log('Div "เพิ่ม" สำหรับ .myPopupsadddeopsit ถูกคลิก! .sidetable แสดง.');
            });
            $addAndHideBtns2.on('click', function () { hidePopup($myPopupsPenView); console.log('Div "เพิ่ม" สำหรับ .myPopuppenview ถูกคลิก! และปิด Popup หลัก'); });
            $addAndHideBtns3.on('click', function () { hidePopup($myPopupsView); console.log('Div "เพิ่ม" สำหรับ .myPopupview ถูกคลิก! และปิด Popup หลัก'); });
            $addAndHideBtns5.on('click', function () { hidePopup($myPopupsEditPen); console.log('Div "เพิ่ม" สำหรับ .myPopupeditpen ถูกคลิก! และปิด Popup หลัก'); });
            $addAndHideBtns6.on('click', function () { hidePopup($myPopupsDeposit); console.log('Div "เพิ่ม" สำหรับ .myPopupdeposit ถูกคลิก! และปิด Popup หลัก'); });
            $addAndHideBtns7.on('click', function () { hidePopup($myPopupsAddDate); console.log('Div "บันทึก" สำหรับ .myPopupadddate ถูกคลิก! และปิด Popup หลัก'); });
            $addAndHideBtns8.on('click', function () { hidePopup($myPopupsViewDate); console.log('Div "เพิ่ม" สำหรับ .myPopupviewdate ถูกคลิก! และปิด Popup หลัก'); });
            $addAndHideBtns9.on('click', function () { hidePopup($myPopupsAddSum); console.log('Div "เพิ่ม" สำหรับ .myPopupaddsum ถูกคลิก! และปิด Popup หลัก'); });
            $addAndHideBtns10.on('click', function () { hidePopup($myPopupsSalesOrder); console.log('Div "เพิ่ม" สำหรับ .myPopupsalesorder ถูกคลิก! และปิด Popup หลัก'); });
            $addAndHideBtns12.on('click', function () { hidePopup($myPopupsSelectReceive); console.log('Div "เพิ่ม" สำหรับ .myPopupselectreceive ถูกคลิก! และปิด Popup หลัก'); });
            $addAndHideBtns13.on('click', function () { hidePopup($myPopupsSelectBill); console.log('Div "เพิ่ม" สำหรับ .myPopupselectbill ถูกคลิก! และปิด Popup หลัก'); });
            $addAndHideBtns14.on('click', function () { hidePopup($myPopupsTableSum); console.log('Div "เพิ่ม" สำหรับ .myPopup14 ถูกคลิก! และปิด Popup หลัก'); });
            $addAndHideBtnsTableBillingSlip.on('click', function () { hidePopup($myPopupsTableBillingSlip); console.log('Div "เพิ่ม" สำหรับ .myPopupsTableBillingSlip ถูกคลิก! และปิด Popup หลัก'); });
            $addAndHideBtnsViewInvoice.on('click', function () { hidePopup($myPopupsViewInvoice); console.log('Div "เพิ่ม" สำหรับ .myPopupsviewinvoice ถูกคลิก! และปิด Popup หลัก'); });
            $sideuploadCancelBtns.on('click', function () { hideSideuploadAndShowMainPopup(); console.log('Div "ยกเลิก" ใน Popup ที่ 2 (.sideupload) ถูกคลิก! กลับไปที่ Popup หลักก่อนหน้า.'); });
            $sideuploadSaveBtns.on('click', function () { hideSideuploadAndShowMainPopup(); console.log('Div "บันทึก" ใน Popup ที่ 2 (.sideupload) ถูกคลิก! กลับไปที่ Popup หลักก่อนหน้า.'); });
            $uploadFileBtns.on('click', function () { console.log('Div "อัปโหลดไฟล์" ใน Popup ที่ 2 (.sideupload) ถูกคลิก!'); hideSideuploadAndShowMainPopup(); });
            $openEditBtns.on('click', function () { console.log('Div "Open Edit" ใน Popup ที่ 2 (.sideupload) ถูกคลิก!'); hideSideuploadAndShowMainPopup(); });
            $newBtns1.on('click', function () { console.log('Div "Div 1" ใน Popup ที่ 2 (.sideupload) ถูกคลิก!'); hideSideuploadAndShowMainPopup(); });
            $newBtns2.on('click', function () { console.log('Div "Div 2" ใน Popup ที่ 2 (.sideupload) ถูกคลิก!'); hideSideuploadAndShowMainPopup(); });
            $newBtns3.on('click', function () { console.log('Div "Div 3" ใน Popup ที่ 2 (.sideupload) ถูกคลิก!'); hideSideuploadAndShowMainPopup(); });
            $newBtns4.on('click', function () { console.log('Div "Div 4" ใน Popup ที่ 2 (.sideupload) ถูกคลิก!'); hideSideuploadAndShowMainPopup(); });
            $newBtns5.on('click', function () { console.log('Div "Div 5" ใน Popup ที่ 2 (.sideupload) ถูกคลิก!'); hideSideuploadAndShowMainPopup(); });
            $sideaddCancelBtns.on('click', function () { hideSideaddAndShowMainPopup($myPopupsAdd); console.log('Div "ยกเลิก" ใน .sideadd ถูกคลิก! กลับไปที่ .myPopupadd.'); });
            $sideaddSaveBtns.on('click', function () { hideSideaddAndShowMainPopup($myPopupsAdd); console.log('Div "เพิ่ม" ใน .sideadd ถูกคลิก! กลับไปที่ .myPopupadd.'); });
            if ($sidetables.length) {
                $sidetableCancelBtns.on('click', function () { hideSidetableAndShowMainPopup(currentMainPopup); console.log('Div "ยกเลิก" ใน .sidetable ถูกคลิก! กลับไปที่ Popup หลักก่อนหน้า.'); });
                $sidetableSaveBtns.on('click', function () { hideSidetableAndShowMainPopup(currentMainPopup); console.log('Div "บันทึก" ใน .sidetable ถูกคลิก! กลับไปที่ Popup หลักก่อนหน้า.'); });
            }
            $hidePopupAdd11.on('click', function () { hidePopup($myPopupsAddDeposit); console.log('ปุ่ม .hidePopupadd11 ถูกคลิก! ซ่อน .myPopup11.'); });
            $hidePopupAdd12.on('click', function () { hidePopup($myPopupsSelectReceive); console.log('ปุ่ม .hidePopupadd12 ถูกคลิก! ซ่อน .myPopupselectreceive.'); });
            $hidePopupAdd13.on('click', function () { hidePopup($myPopupsSelectBill); console.log('ปุ่ม .hidePopupadd13 ถูกคลิก! ซ่อน .myPopupselectbill.'); });
            $hidePopupAdd14.on('click', function () { hidePopup($myPopupsTableSum); console.log('ปุ่ม .hidePopupadd14 ถูกคลิก! ซ่อน .myPopup14.'); });
            $hidePopupAddTableBillingSlip.on('click', function () { hidePopup($myPopupsTableBillingSlip); console.log('ปุ่ม .hidePopupAddTableBillingSlip ถูกคลิก! ซ่อน .myPopupsTableBillingSlip.'); });
            $hidePopupAddViewInvoice.on('click', function () { hidePopup($myPopupsViewInvoice); console.log('ปุ่ม .hidePopupAddViewInvoice ถูกคลิก! ซ่อน .myPopupsviewinvoice.'); });
            $('.right-under-long, .right-under, .modal-select').on('change', function () {
                if ($(this).val() === 'เลือกประเภทเอกสาร' || $(this).val() === 'เลือก...' || $(this).val() === '') {
                    $(this).removeClass('text-black-select-modal');
                    $(this).css('color', '');
                } else {
                    $(this).addClass('text-black-select-modal');
                    $(this).css('color', 'var(--input-text-black)');
                }
            });
            $('.right-under-long, .right-under, .modal-select').each(function () {
                if ($(this).val() !== 'เลือกประเภทเอกสาร' && $(this).val() !== 'เลือก...' && $(this).val() !== '') {
                    $(this).addClass('text-black-select-modal');
                    $(this).css('color', 'var(--input-text-black)');
                } else {
                    $(this).removeClass('text-black-select-modal');
                    $(this).css('color', '');
                }
            });
        });
       //อันนี้จะติ้กได้แค่หน้าก่อนอนุมัติ
        $(document).ready(function () {
    function updateSignatureBox() {
        const showSignature = $('#signature-option').is(':checked');
        const showMaker = $('#not-show-name').is(':checked');

        if (showMaker) {
            $('#signature-maker-box').hide();
        } else if (showSignature) {
            $('#signature-maker-box').show();
        } else {
            $('#signature-maker-box').hide();
        }
    }

    // ตั้งค่าตั้งต้น: ให้ติ๊ก "แสดงลายเซ็น"
    $('#signature-option').prop('checked', true);
    $('#not-show-name').prop('checked', false);
    updateSignatureBox();

    $('#not-show-name').on('change', function () {
        if ($(this).is(':checked')) {
            $('#signature-option').prop('checked', false);
        }
        updateSignatureBox();
    });

    $('#signature-option').on('change', function () {
        if ($(this).is(':checked')) {
            $('#not-show-name').prop('checked', false);
        }
        updateSignatureBox();
    });
});
 $(document).ready(function () {
                 const customerNoteunder = localStorage.getItem('customerNoteunder') || '';
    $('#customerNoteunderDisplay').text(customerNoteunder);
    
    const customerCode = localStorage.getItem('customerCode') || '';
    $('#customerCodeDisplay').text(customerCode);

    const customerName = localStorage.getItem('customerName') || '';
    $('#customerNameDisplay').text(customerName);

    const customerAddress = localStorage.getItem('customerAddress') || '';
    $('#customerAddressDisplay').text(customerAddress); 

    const customerPhone = localStorage.getItem('customerPhone') || '';
    $('#customerPhoneDisplay').text(customerPhone); 

    const customerHeadOffice = localStorage.getItem('customerHeadOffice') || '';
    $('#customerHeadOfficeDisplay').text(customerHeadOffice); 

    const customerContactName = localStorage.getItem('customerContactName') || '';
    $('#customerContactNameDisplay').text(customerContactName); 

    const customerGmail = localStorage.getItem('customerGmail') || '';
    $('#customerGmailDisplay').text(customerGmail); 


    const customerBranchCode = localStorage.getItem('customerBranchCode') || '';
    $('#customerBranchCodeDisplay').text(customerBranchCode);

    const customerBranchName = localStorage.getItem('customerBranchName') || '';
    $('#customerBranchNameDisplay').text(customerBranchName);

    const customerStatus = localStorage.getItem('customerStatus') || '';
    $('#customerStatusDisplay').text(customerStatus);

    const customerDay = localStorage.getItem('customerDay') || '';
    $('#customerDayDisplay').text(customerDay); 
const rawDate = localStorage.getItem('customerPaymentDate') || '';
    
    // ฟังก์ชันแปลงวันที่
function formatDateToDDMMYYYY(dateStr) {
        if (!dateStr || !dateStr.includes('-')) return dateStr;
        const [year, month, day] = dateStr.split('-');
        return `${day}/${month}/${year}`;
    }
    // แปลงและแสดงผล
    const customerPaymentDate = formatDateToDDMMYYYY(rawDate);
    $('#customerPaymentDateDisplay').text(customerPaymentDate);
    
     const customerDayfully = localStorage.getItem('customerDayfully') || '';
    $('#customerDayfullyDisplay').text(customerDayfully);
    function formatDateToDDMMYYYY(dateStr) {
    if (!dateStr || !dateStr.includes('-')) return dateStr;
    const [year, month, day] = dateStr.split('-');
    return `${day}/${month}/${year}`;
  }
  const formattedDate = formatDateToDDMMYYYY(customerDayfully);
  $('#customerDayfullyDisplay').text(formattedDate);
  const formattedCustomerDay = formatDateToDDMMYYYY(customerDay);
  $('#customerDayDisplay').text(formattedCustomerDay);
  
  

    const customerDueDate = localStorage.getItem('customerDueDate') || '';
    $('#customerDueDateDisplay').text(customerDueDate);

    const customerDepartment = localStorage.getItem('customerDepartment') || '';
    $('#customerDepartmentDisplay').text(customerDepartment);

    const customerSalesperson = localStorage.getItem('customerSalesperson') || '';
    $('#customerSalespersonDisplay').text(customerSalesperson);

    const customerPriceandTax = localStorage.getItem('customerPriceandTax') || '';
    $('#customerPriceandTaxDisplay').text(customerPriceandTax);

    const customerDepositReceiptNumber = localStorage.getItem('customerDepositReceiptNumber') || '';
    $('#customerDepositReceiptNumberDisplay').text(customerDepositReceiptNumber);

     const customerCurrency = localStorage.getItem('customerCurrency') || '';
    $('#customerCurrencyDisplay').text(customerCurrency);

    const customerCredithistory = localStorage.getItem('customerCredithistory') || '';
    $('#customerCredithistoryDisplay').text(customerCredithistory);

       const storedEmployee = localStorage.getItem('customerEmployee') || '';
if (storedEmployee) {
    $('#customerEmployeeDisplay').text(storedEmployee);
}
     const customerCounty = localStorage.getItem('customerCounty') || '';
    $('#customerCountyDisplay').text(customerCounty);

     const customerExpress = localStorage.getItem('customerExpress') || '';
    $('#customerExpressDisplay').text(customerExpress);
     const customerClaim = localStorage.getItem('customerClaim') || '';
    $('#customerClaimDisplay').text(customerClaim);

    });
    $(document).ready(function(){
        const customerNote = localStorage.getItem('customerNote') || '';
    $('#customerNoteDisplay').text(customerNote);
    });
    function setVendorName() {
    // ตรวจสอบก่อนว่ามีค่าหรือไม่ (ไม่จำเป็นก็ได้)
    const customerName = document.getElementById('customerNameDisplay')?.innerText || '';
    localStorage.setItem('customerName', customerName);
    
    const customerCode = document.getElementById('customerCodeDisplay')?.innerText || '';
    localStorage.setItem('customerCode', customerCode);

    const customerDepartment = document.getElementById('customerDepartmentDisplay')?.innerText || '';
    localStorage.setItem('customerDepartment', customerDepartment);

       const currentEmployee = document.getElementById('customerEmployeeDisplay')?.innerText || '';
localStorage.setItem('customerEmployee', currentEmployee);

    const customerDepositReceiptNumber = document.getElementById('customerDepositReceiptNumberDisplay')?.innerText || '';
    localStorage.setItem('customerDepositReceiptNumber',customerDepositReceiptNumber);



// สมมุติว่า buyDayDisplay เป็น "13/01/2025" ➜ ต้องแปลงก่อน
function convertDDMMYYYYToYYYYMMDD(dateStr) {
    const [day, month, year] = dateStr.split('/');
    return `${year}-${month}-${day}`;
}

let rawCustomerDay = document.getElementById('customerPaymentDateDisplay')?.innerText || '';
if (rawCustomerDay.includes('/')) {
    rawCustomerPaymentDate = convertDDMMYYYYToYYYYMMDD(rawCustomerPaymentDate);
}

localStorage.setItem('customerPaymentDate', rawCustomerPaymentDate);
localStorage.setItem('customerDay', rawCustomerDay);

}



function loadQuotationPreviewData() {
    // ดึง ID จาก URL parameter
    const urlParams = new URLSearchParams(window.location.search);
    const quotationId = urlParams.get('id');
    
    // ตรวจสอบว่ามีข้อมูลใน localStorage หรือไม่
    const localQuotationData = localStorage.getItem('quotationData');
    const localQuotationId = localStorage.getItem('quotationId');
    
    if (quotationId) {
        // ถ้ามี ID ใน URL ให้โหลดจากฐานข้อมูล
        console.log('Loading quotation data for ID:', quotationId);
        
        $.ajax({
            url: `${endpoint}/api/get_quotation_by_id`,
            method: 'POST',
            dataType: 'json',
            data: {
                id: quotationId,
                com_id: localStorage.getItem('com_id') || 5
            },
            success: function(response) {
                console.log('Quotation preview API Response:', response);
                if (response.code === 200) {
                    displayQuotationPreviewData(response.result);
                } else {
                    console.error('Error loading quotation data:', response.result);
                    // ถ้าโหลดจาก API ไม่ได้ ให้ลองใช้ข้อมูลจาก localStorage
                    if (localQuotationData) {
                        console.log('Falling back to localStorage data');
                        const parsedData = JSON.parse(localQuotationData);
                        displayQuotationPreviewData(parsedData);
                    } else {
                        alert('ไม่พบข้อมูลใบเสนอราคา');
                    }
                }
            },
            error: function(xhr, status, error) {
                console.error('Error loading quotation data:', error);
                // ถ้าโหลดจาก API ไม่ได้ ให้ลองใช้ข้อมูลจาก localStorage
                if (localQuotationData) {
                    console.log('Falling back to localStorage data due to API error');
                    const parsedData = JSON.parse(localQuotationData);
                    displayQuotationPreviewData(parsedData);
                } else {
                    alert('เกิดข้อผิดพลาดในการโหลดข้อมูล');
                }
            }
        });
    } else if (localQuotationData) {
        // ถ้าไม่มี ID ใน URL แต่มีข้อมูลใน localStorage ให้ใช้ข้อมูลจาก localStorage
        console.log('Loading quotation data from localStorage');
        const parsedData = JSON.parse(localQuotationData);
        displayQuotationPreviewData(parsedData);
    } else {
        console.error('No quotation ID found in URL and no data in localStorage');
        alert('ไม่พบข้อมูลใบเสนอราคา');
    }
}

// ฟังก์ชันสำหรับแสดงข้อมูลใบเสนอราคา
function displayQuotationPreviewData(data) {
    console.log('Displaying quotation data:', data);
    
    // ตรวจสอบว่าข้อมูลมาจาก localStorage หรือไม่
    let cusDetail = {};
    let docDetail = {};
    
    // ถ้าข้อมูลมาจาก localStorage จะมีโครงสร้างที่แตกต่าง
    if (data.cus_detail && typeof data.cus_detail === 'string') {
        try {
            cusDetail = JSON.parse(data.cus_detail);
        } catch (e) {
            console.error('Error parsing cus_detail:', e);
            cusDetail = {};
        }
    } else if (data.cus_detail && typeof data.cus_detail === 'object') {
        cusDetail = data.cus_detail;
    }
    
    if (data.doc_detail && typeof data.doc_detail === 'string') {
        try {
            docDetail = JSON.parse(data.doc_detail);
        } catch (e) {
            console.error('Error parsing doc_detail:', e);
            docDetail = {};
        }
    } else if (data.doc_detail && typeof data.doc_detail === 'object') {
        docDetail = data.doc_detail;
    }
    
    // แสดงข้อมูลพื้นฐาน
    if (data.net_amount) {
        $('.deposit-receipt-box-mini-number-in').text(formatCurrency(data.net_amount));
    }
    
    // แสดงข้อมูลลูกค้า
    if (data.tx) {
        $('#customerDepositReceiptNumberDisplay').text(data.tx);
        $('#headerDocumentNumber').text(data.tx);
    }
    if (data.cus_name) $('#customerNameDisplay').text(data.cus_name);
    if (data.cus_no) $('#customerCodeDisplay').text(data.cus_no);
    
    // แสดงเบอร์โทรศัพท์
    if (cusDetail.cus_phone) {
        let phoneNumber = cusDetail.cus_phone;
        // แปลงเบอร์โทรศัพท์ให้เป็นรูปแบบ 080-870-5488
        if (phoneNumber && phoneNumber.length >= 10) {
            // ลบตัวอักษรที่ไม่ใช่ตัวเลขออก
            let cleanNumber = phoneNumber.replace(/\D/g, '');
            if (cleanNumber.length >= 10) {
                // แปลงเป็นรูปแบบ 080-870-5488
                phoneNumber = cleanNumber.substring(0, 3) + '-' + 
                             cleanNumber.substring(3, 6) + '-' + 
                             cleanNumber.substring(6, 10);
            }
        }
        $('#customerPhoneDisplay').text(phoneNumber);
    }
    
    // แสดงที่อยู่ลูกค้า
    if (cusDetail.cus_addr) {
        $('#customerAddressDisplay').text(cusDetail.cus_addr);
    }
    
    // แสดงที่ตั้งธุรกิจ
    if (cusDetail.cus_business_location) {
        $('#customerHeadOfficeDisplay').text(cusDetail.cus_business_location);
    }
    
    // แสดงชื่อผู้ติดต่อ
    if (cusDetail.cus_contact_name) {
        $('#customerContactNameDisplay').text(cusDetail.cus_contact_name);
    }
    
    // แสดงอีเมล
    if (cusDetail.cus_email) {
        $('#customerGmailDisplay').text(cusDetail.cus_email);
    }
    
    // แสดงอ้างอิง (ไม่แสดง เพราะหมายเหตุจะใช้แทน)
    // if (cusDetail.cus_refer) {
    //     $('#customerReferDisplay').text(cusDetail.cus_refer);
    // }
    
    // แสดงประเภทสำนักงาน
    if (cusDetail.cus_head_office !== undefined) {
        $('#customerSubbranchDisplay').text(cusDetail.cus_head_office ? 'สำนักงานใหญ่ :' : 'สาขาย่อย :');
    }
    
    // แสดงรหัสสาขา
    if (cusDetail.cus_branch_no) {
        $('#customerBranchCodeDisplay').text(cusDetail.cus_branch_no);
    }
    
    // แสดงชื่อสาขา
    if (cusDetail.cus_branch_name) {
        $('#customerBranchNameDisplay').text(cusDetail.cus_branch_name);
    }

    // แสดงข้อมูลเอกสาร
    if (data.doc_status) {
        let statusText = data.doc_status;
        if (data.doc_status === 'pending') {
            statusText = 'รออนุมัติ';
        } else if (data.doc_status === 'approved') {
            statusText = 'อนุมัติ';
        } else if (data.doc_status === 'rejected') {
            statusText = 'ไม่อนุมัติ';
        }
        $('#customerStatusDisplay').text(data.status);
        
        // จัดการการแสดงปุ่มตามสถานะ
        handleButtonDisplayByStatus(data.doc_status);
    }
    
    // แสดงวันที่เอกสาร
    if (data.doc_date) {
        $('#customerDayDisplay').text(formatDateForDisplay(data.doc_date));
        $('#customerDateDisplay').text(formatDateForDisplay(data.doc_date));
    } else if (data.created_date) {
        $('#customerDateDisplay').text(formatDateForDisplay(data.created_date));
    }
    
    // แสดงวันครบกำหนด
    if (data.due_date) {
        $('#customerDayfullyDisplay').text(formatDateForDisplay(data.due_date));
        // อัปเดตวันที่ชำระด้วยข้อมูลเดียวกัน
        $('#customerPaymentDateDisplay').text(formatDateForDisplay(data.due_date));
    } else if (data.payment_date) {
        $('#customerPaymentDateDisplay').text(formatDateForDisplay(data.payment_date));
    }
    
    // แสดงกำหนดยื่น
    if (docDetail.deadline) {
        $('#customerDueDateDisplay').text(docDetail.deadline);
    }
    
    // แสดงแผนก
    if (docDetail.department) {
        $('#customerDepartmentDisplay').text(docDetail.department);
    } else if (data.department_type) {
        $('#customerDepartmentDisplay').text(data.department_type);
    }
    
    // แสดงพนักงานขาย
    if (docDetail.salesman) {
        $('#customerSalesperson').text(docDetail.salesman);
        $('#customerSalespersonDisplay').text(docDetail.salesman);
        // อัปเดตพนักงานขายในส่วนข้อมูลเอกสาร
        $('#customerEmployeeDisplay').text(docDetail.salesman);
    } else if (data.salesman) {
        $('#customerSalesperson').text(data.salesman);
        $('#customerSalespersonDisplay').text(data.salesman);
        $('#customerEmployeeDisplay').text(data.salesman);
    }
    
    // แสดงรหัสใบสั่งขาย
    if (docDetail.sales_order_code) {
        $('#salesOrderRefDisplay').text(docDetail.sales_order_code);
    }
    
    // แสดงเครดิตจากประวัติชำระเงิน
    if (docDetail.credit_history) {
        $('#customerCredithistoryDisplay').text(docDetail.credit_history);
    }
    
    // แสดงเขตการขาย
    if (docDetail.sales_area || docDetail.territory) {
        $('#customerCountyDisplay').text(docDetail.sales_area || docDetail.territory);
    }
    
    // แสดงภาระภาษีขาย
    if (docDetail.tax_claim) {
        $('#customerClaimDisplay').text(docDetail.tax_claim);
    }
    
    // แสดง/ซ่อนการออกใบกำกับภาษี
    if (docDetail.tax_invoice !== undefined) {
        if (docDetail.tax_invoice === true || docDetail.tax_invoice === 'true') {
            $('.issuance-of-tax-invoices-box').show();
            $('.head-three').css('height', '515px');
        } else {
            $('.issuance-of-tax-invoices-box').hide();
            $('.head-three').css('height', 'auto');
        }
    } else {
        $('.issuance-of-tax-invoices-box').hide();
        $('.head-three').css('height', 'auto');
    }
    
    // แสดงข้อมูลราคาและภาษี
    if (docDetail.data_price_tax) {
        $('#customerPriceandTaxDisplay').text(docDetail.data_price_tax);
    }
    
    // แสดงสกุลเงิน
    if (docDetail.currency) {
        $('#customerCurrencyDisplay').text(docDetail.currency);
    }
    
    // แสดงหมายเหตุ
    if (data.remark) {
        $('#customerNoteunderDisplay').text(data.remark);
    } else if (cusDetail.cus_refer) {
        $('#customerNoteunderDisplay').text(cusDetail.cus_refer);
    }
    
    // แสดงหมายเหตุในช่องต้นเอกสารด้วย
    if (cusDetail.cus_refer) {
        $('#customerNoteDisplay').text(cusDetail.cus_refer);
    } else if (data.remark) {
        $('#customerNoteDisplay').text(data.remark);
    }
    
    // แสดงไฟล์
    if (data.file && Array.isArray(data.file)) {
        displayFileList(data.file);
    } else if (data.file) {
        // รองรับกรณีที่ file เป็น object เดียว
        $('#customerFileDisplay').text(data.file.name);
    }
    
    // แสดงสถานะ checkbox ลายเซ็นต์อิเล็กทรอนิกและตรายาง
    if (cusDetail.cus_visits === true || cusDetail.cus_visits === 'true') {
        $('#list-tax-1').prop('checked', true);
    } else {
        $('#list-tax-1').prop('checked', false);
    }

    // แสดงข้อมูลราคาและภาษี
    if (data.product_detail) {
        $('#product-totalAllProducts').text(formatCurrency(data.product_detail.product_totalAllProducts));
        $('#product-totalDiscount').text(formatCurrency(data.product_detail.product_totalDiscount));
        $('#product-totalAfterDiscount').text(formatCurrency(data.product_detail.product_totalAfterDiscount));
        $('#product-totalTax').text(formatCurrency(data.product_detail.product_totalTax));
        
        // คำนวณรวม withholdingTax ทั้ง 3 อัน
        const withholdingTax1 = parseFloat(data.product_detail.product_withholdingTax) || 0;
        const withholdingTax2 = parseFloat(data.product_detail.product_withholdingTax2) || 0;
        const withholdingTax3 = parseFloat(data.product_detail.product_withholdingTax3) || 0;
        const totalWithholdingTax = withholdingTax1 + withholdingTax2 + withholdingTax3;
        
        $('#product-withholdingTax').text(formatCurrency(totalWithholdingTax));
        $('#product-totalAll').text(formatCurrency(data.product_detail.product_totalAll));
        $('#product-totalAll-2').text(formatCurrency(data.product_detail.product_totalAll));
        
        // คำนวณและแสดงผลในส่วน "รอหักมัดจำ"
        const productTotalAllProducts = parseFloat(data.product_detail.product_totalAllProducts) || 0;
        const productTotalTax = parseFloat(data.product_detail.product_totalTax) || 0;
        
        // มูลค่ารวมภาษี = product_totalAllProducts + product_totalTax
        const depositTotalWithTax = productTotalAllProducts + productTotalTax;
        
        // ยอดชำระจริง = มูลค่ารวมภาษี - ภาษีถูกหัก ณ ที่จ่าย
        const depositActualPayment = depositTotalWithTax - totalWithholdingTax;
        
        $('#deposit-total-with-tax').text(formatCurrency(depositTotalWithTax));
        $('#deposit-withholding-tax').text(formatCurrency(totalWithholdingTax));
        $('#deposit-actual-payment').text(formatCurrency(depositActualPayment));
        
        // อัปเดตวันที่รับชำระครบให้ใช้ค่าเดียวกันกับ customerDayfullyDisplay
        const dueDateText = $('#customerDayfullyDisplay').text();
        if (dueDateText) {
            $('#deposit-due-date').text('รับชำระครบได้ถึงวันที่: ' + dueDateText);
        }
        
        // แสดงสถานะ checkbox ภาษีมูลค่าเพิ่ม 7%
        if (data.product_detail.vat7_checked !== undefined) {
            $('#list-tax').prop('checked', data.product_detail.vat7_checked);
            // ควบคุมการแสดง/ซ่อนจำนวนเงินภาษีมูลค่าเพิ่ม 7%
            if (data.product_detail.vat7_checked) {
                $('#product-totalTax').parent().parent().show();
            } else {
                $('#product-totalTax').parent().parent().hide();
            }
        } else {
            // ถ้าไม่มีข้อมูล checkbox ให้ซ่อนจำนวนเงิน
            $('#product-totalTax').parent().parent().hide();
        }
        
        // แสดงสถานะ checkbox ภาษีถูกหัก ณ ที่จ่าย
        if (data.product_detail.withholding_tax_checked !== undefined) {
            $('#list-tax-2').prop('checked', data.product_detail.withholding_tax_checked);
            // ควบคุมการแสดง/ซ่อน dropdown และจำนวนเงิน
            if (data.product_detail.withholding_tax_checked) {
                $('#withholding-tax-rate').parent().show();
                $('#product-withholdingTax').parent().parent().show();
            } else {
                $('#withholding-tax-rate').parent().hide();
                $('#product-withholdingTax').parent().parent().hide();
            }
        } else {
            // ถ้าไม่มีข้อมูล checkbox ให้ซ่อน dropdown และจำนวนเงิน
            $('#withholding-tax-rate').parent().hide();
            $('#product-withholdingTax').parent().parent().hide();
        }
        
        // แสดงสถานะ checkbox ตัดมัดจำเรียบร้อย
        if (data.payment_detail.deposit_deduction !== undefined) {
            $('#deposit_deduction').prop('checked', data.payment_detail.deposit_deduction);
            // เปิดใช้งาน checkbox เมื่อ deposit_deduction เป็น true
            if (data.payment_detail.deposit_deduction) {
                $('#deposit_deduction').prop('disabled', true);
                // เปลี่ยนสี background เมื่อเป็น true
                $('#deposit_deduction').next('.slider').css('background-color', 'var(--toggle-color400)');
                // แสดง deposittwo invisible-one และซ่อน box-deposittree
                $('.deposittwo.invisible-one').show();
                $('.box-deposittree').hide();
            } else {
                $('#deposit_deduction').prop('disabled', true);
                // ซ่อน deposittwo invisible-one และแสดง box-deposittree
                $('.deposittwo.invisible-one').hide();
                $('.box-deposittree').show();
                
                // เปลี่ยน tabs structure เมื่อ deposit_deduction ไม่ใช่ true
                $('.tabs-3').removeClass('tabs-3').addClass('tabs');
                $('.tab-3').removeClass('tab-3').addClass('tab');
                $('.glider-3').removeClass('glider-3').addClass('glider');
                $('label.tab[for="radio-2"]').text('ข้อมูลการชำระ');
            }
        } else {
            // ถ้าไม่มีข้อมูล deposit_deduction ให้ปิดใช้งาน checkbox
            $('#deposit_deduction').prop('disabled', true);
            // แสดง box-deposittree เป็นค่าเริ่มต้น
            $('.deposittwo.invisible-one').hide();
            $('.box-deposittree').show();
            
            // เปลี่ยน tabs structure เมื่อไม่มีข้อมูล deposit_deduction
            $('.tabs-3').removeClass('tabs-3').addClass('tabs');
            $('.tab-3').removeClass('tab-3').addClass('tab');
            $('.glider-3').removeClass('glider-3').addClass('glider');
            $('label.tab[for="radio-2"]').text('ข้อมูลการชำระ');
        }
        
        // แสดงข้อมูลสรุปการชำระเงินจาก payment_detail.payment_summary
        if (data.payment_detail.payment_summary) {
            const paymentSummary = data.payment_detail.payment_summary;
            
            
            // อัปเดตค่าสรุปการชำระเงินในส่วน deposittwo
            if (paymentSummary.total_with_tax) {
                $('.deposittwo .deposit-gap .money').eq(0).text(formatCurrency(paymentSummary.total_with_tax)); // มูลค่ารวมภาษี
            }
            if (paymentSummary.withholding_tax) {
                $('.deposittwo .deposit-gap .money').eq(1).text(formatCurrency(paymentSummary.withholding_tax)); // ภาษีถูกหัก ณ ที่จ่าย
            }
            if (paymentSummary.remaining_amount) {
                $('.deposittwo .deposit-gap .money').eq(2).text(formatCurrency(paymentSummary.remaining_amount)); // ยอดคงค้าง
            }
            if (paymentSummary.paid_amount) {
                $('.deposittwo .deposit-gap .money').eq(3).text(formatCurrency(paymentSummary.paid_amount)); // ยอดที่ตัดไปแล้ว
            }
            if (paymentSummary.total_payment) {
                $('.deposittwo .deposit-gap .money').eq(4).text(formatCurrency(paymentSummary.total_payment)); // ยอดชำระจริง
            }
            
            // อัปเดตค่าสรุปการชำระเงินในส่วน bank-box
            if (paymentSummary.total_with_tax) {
                $('.bank-box .deposit-gap .money').eq(0).text(formatCurrency(paymentSummary.total_with_tax)); // มูลค่ารวมภาษี
            }
            if (paymentSummary.withholding_tax) {
                $('.bank-box .deposit-gap .money').eq(1).text(formatCurrency(paymentSummary.withholding_tax)); // ภาษีถูกหัก ณ ที่จ่าย
            }
            if (paymentSummary.total_payment) {
                $('.bank-box .sell-all-box-in-number').text(formatCurrency(paymentSummary.total_payment)); // ชำระรวมทั้งสิ้น
            }
            
            // อัปเดตค่าสรุปการชำระเงินในส่วน box-deposittree
            if (paymentSummary.total_with_tax) {
                $('#deposit-total-with-tax').text(formatCurrency(paymentSummary.total_with_tax)); // มูลค่ารวมภาษี
            }
            if (paymentSummary.withholding_tax) {
                $('#deposit-withholding-tax').text(formatCurrency(paymentSummary.withholding_tax)); // ภาษีถูกหัก ณ ที่จ่าย
            }
            if (paymentSummary.total_payment) {
                $('#deposit-actual-payment').text(formatCurrency(paymentSummary.total_payment)); // ยอดชำระจริง
            }
        }
        
        // แสดงวันที่รับชำระครบจาก payment_detail.deposit_due_date
        if (data.payment_detail.deposit_due_date) {
            const depositDueDate = data.payment_detail.deposit_due_date;
            
            // แปลงวันที่เป็นรูปแบบ DD/MM/YYYY
            const formatDate = (dateString) => {
                if (!dateString) return '';
                const date = new Date(dateString);
                if (isNaN(date.getTime())) return dateString; // ถ้าแปลงไม่ได้ให้คืนค่าเดิม
                
                const day = String(date.getDate()).padStart(2, '0');
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const year = date.getFullYear();
                return `${day}/${month}/${year}`;
            };
            
            const formattedDate = formatDate(depositDueDate);
            $('.depo-hub-text4').text('รับชำระครบเมื่อวันที่: ' + formattedDate);
            $('#deposit-due-date').text('รับชำระครบได้ถึงวันที่: ' + formattedDate);
        }
        
        // แสดงข้อมูลการชำระเงินตาม selected_payment_method
        if (data.payment_detail.selected_payment_method === "page2") {
            // ธนาคาร
            // แสดงชื่อธนาคารและโลโก้
            if (data.payment_detail.bank_name) {
                $('.bank-name-text').text(data.payment_detail.bank_name);
                
                // แสดงโลโก้ธนาคารตามชื่อ
                const getBankLogo = (bankName) => {
                    const bank = bankName.toLowerCase();
                    let logoHtml = '';
                    
                    if (bank.includes('ไทยพาณิชย์')) {
                        logoHtml = '<img src="picture/ไทยพาณิช.png" alt="ไทยพาณิชย์" style="width: 28px; height: 28px; object-fit: contain; border-radius: 28px;">';
                    } else if (bank.includes('กสิกร')) {
                        logoHtml = '<img src="picture/กสิกร.png" alt="กสิกรไทย" style="width: 28px; height: 28px; object-fit: contain; border-radius: 28px;">';
                    } else if (bank.includes('กรุงไทย')) {
                        logoHtml = '<img src="picture/กรุงไทย.png" alt="กรุงไทย" style="width: 28px; height: 28px; object-fit: contain; border-radius: 28px;">';
                    }
                    
                    return logoHtml;
                };
                
                $('.bank-box-name-page-two').html(getBankLogo(data.payment_detail.bank_name));
            }
            
            // แสดงหมายเลขบัญชีธนาคารในรูปแบบ 123-4-XXXXX-0
            if (data.payment_detail.bank_account_number) {
                const formatBankAccount = (accountNumber) => {
                    if (!accountNumber) return '';
                    // ลบตัวอักษรที่ไม่ใช่ตัวเลขออก
                    const numbers = accountNumber.replace(/\D/g, '');
                    if (numbers.length < 3) return accountNumber;
                    
                    // แบ่งเป็นส่วนๆ ตามรูปแบบ 123-4-XXXXX-0
                    let formatted = numbers.substring(0, 3); // 123
                    if (numbers.length > 3) {
                        formatted += '-' + numbers.substring(3, 4); // -4
                    }
                    if (numbers.length > 4) {
                        const middlePart = numbers.substring(4, numbers.length - 1);
                        const xCount = Math.min(5, middlePart.length);
                        formatted += '-' + 'X'.repeat(xCount); // -XXXXX
                    }
                    if (numbers.length > 1) {
                        formatted += '-' + numbers.substring(numbers.length - 1); // -0
                    }
                    
                    return formatted;
                };
                
                $('.number-bank-pagetwo').text(formatBankAccount(data.payment_detail.bank_account_number));
            }

            // แสดงวันที่และเวลาการชำระเงินธนาคาร
            if (data.payment_detail.bank_payment_date) {
                // แปลงวันที่เป็นรูปแบบ DD/MM/YYYY
                const formatDate = (dateString) => {
                    if (!dateString) return '';
                    const date = new Date(dateString);
                    if (isNaN(date.getTime())) return dateString;
                    
                    const day = String(date.getDate()).padStart(2, '0');
                    const month = String(date.getMonth() + 1).padStart(2, '0');
                    const year = date.getFullYear();
                    return `${day}/${month}/${year}`;
                };
                
                const formattedDate = formatDate(data.payment_detail.bank_payment_date);
                $('.time-number-text').eq(0).text(formattedDate);
            }
            
            if (data.payment_detail.bank_payment_time) {
                $('.time-number-text').eq(1).text(data.payment_detail.bank_payment_time);
            }
            
        } else if (data.payment_detail.selected_payment_method === "page1") {
            // เงินสด
            $('.bank-title').text('เงินสด');
            $('.bank-box-name-page-two').html('<img src="picture/user.png" alt="เงินสด" style="width: 28px; height: 28px; object-fit: contain;">');
           
            // แสดงชื่อผู้จ่าย
            if (data.payment_detail.payment_payee_name) {
                $('.bank-name-text').text(data.payment_detail.payment_payee_name);
            }

            // แสดงรายละเอียด
            if (data.payment_detail.payment_description) {
                $('.number-bank-pagetwo').text(data.payment_detail.payment_description);
            }

            // แสดงวันที่และเวลา
            if (data.payment_detail.payment_date) {
                // แปลงวันที่เป็นรูปแบบ DD/MM/YYYY
                const formatDate = (dateString) => {
                    if (!dateString) return '';
                    const date = new Date(dateString);
                    if (isNaN(date.getTime())) return dateString;
                    
                    const day = String(date.getDate()).padStart(2, '0');
                    const month = String(date.getMonth() + 1).padStart(2, '0');
                    const year = date.getFullYear();
                    return `${day}/${month}/${year}`;
                };
                
                const formattedDate = formatDate(data.payment_detail.payment_date);
                $('.time-number-text').eq(0).text(formattedDate);
            }
            
            if (data.payment_detail.payment_time) {
                $('.time-number-text').eq(1).text(data.payment_detail.payment_time);
            }
        }
        
        // แสดงอัตราภาษีถูกหัก ณ ที่จ่าย
        if (data.product_detail.withholding_tax_rate) {
            $('#withholding-tax-rate').val(data.product_detail.withholding_tax_rate);
        }
    }

}

// ฟังก์ชันแปลงมูลค่าเป็นรูปแบบเงิน
function formatCurrency(value) {
    const numValue = parseFloat(value) || 0;
    return numValue.toLocaleString('en-US', {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2
    });
}

// ฟังก์ชันสำหรับแปลงรูปแบบวันที่สำหรับแสดงผล
function formatDateForDisplay(dateStr) {
    if (!dateStr) return '-';
    
    // ถ้าเป็นรูปแบบ DD/MM/YY หรือ DD/MM/YYYY
    if (dateStr.includes('/')) {
        return dateStr;
    }
    
    // ถ้าเป็นรูปแบบ YYYY-MM-DD
    if (dateStr.includes('-') && dateStr.split('-')[0].length === 4) {
        const [year, month, day] = dateStr.split('-');
        return `${day}/${month}/${year}`;
    }
    
    return dateStr;
}

// ฟังก์ชันสำหรับจัดการการแสดงปุ่มตามสถานะ
function handleButtonDisplayByStatus(docStatus) {
    console.log('Handling button display for status:', docStatus);
    
    if (docStatus === 'approved') {
        // ถ้าอนุมัติแล้ว ให้ซ่อนปุ่มแก้ไขและอนุมัติ แสดงปุ่มกลับ
        $('#btnEdit').hide();
        $('#btnApprove').hide();
        $('#goBack').show();
        
        // เปลี่ยนหัวข้อเป็น "อนุมัติการจ่ายเงินมัดจำ"
        $('#quotationTitle').hide();
        $('#approveTitle').show();
        $('#historyTitle').hide();
        
        // ซ่อนปุ่มใน navbar
        $('#btnnone').hide();
        
    } else {
        // ถ้ายังรออนุมัติ ให้แสดงปุ่มแก้ไขและอนุมัติ ซ่อนปุ่มกลับ
        $('#btnEdit').show();
        $('#btnApprove').show();
        $('#goBack').hide();
        
        // แสดงหัวข้อปกติ
        $('#quotationTitle').show();
        $('#approveTitle').hide();
        $('#historyTitle').hide();
        
        // แสดงปุ่มใน navbar
        $('#btnnone').show();
    } 
}

// ฟังก์ชันสำหรับไปยังหน้า paperbill.html พร้อมส่ง ID
function goToPaperDepositReceipt() {
    // ดึง ID จาก URL parameter
    const urlParams = new URLSearchParams(window.location.search);
    const quotationId = urlParams.get('id');
    
    // เปิดหน้าใหม่ paperbill.html พร้อมส่ง ID
    window.open(`paperbill.html?id=${quotationId}`, '_blank');
}
    </script>
</body>
</html>