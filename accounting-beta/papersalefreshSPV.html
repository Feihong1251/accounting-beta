<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏´‡∏ô‡∏µ‡πâ</title>
  <style>
          body {
            background-color: rgb(71, 71, 71);
            margin: 0;
            padding: 20px;
        }
        
   @page { size: A4; margin: 10mm; } 
  * { box-sizing: border-box; }

  @media print {
    body { margin: 0; padding: 0; background: transparent !important; }
    .a4-sheet { width: 190mm; min-height: 277mm; margin: 0 auto; }
    table { margin-left: auto; margin-right: auto; }
  }

  @media screen {
    .a4-sheet { width: 210mm; min-height: 297mm; margin: 0 auto; }
  }

  /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏õ‡∏∏‡πà‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå‡πÅ‡∏•‡∏∞‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î */
  .print-button, .download-button {
    position: fixed;
    top: 20px;
    color: white;
    border: none;
    padding: 12px 24px;
    font-size: 16px;
    border-radius: 8px;
    cursor: pointer;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    z-index: 1000;
    transition: background-color 0.3s;
    margin-left: 10px;
  }

  .print-button {
    right: 20px;
    background-color: #4CAF50;
  }

  .download-button {
    right: 140px;
    background-color: #2196F3;
  }

  .print-button:hover {
    background-color: #45a049;
  }

  .print-button:active {
    background-color: #3d8b40;
  }

  .download-button:hover {
    background-color: #1976D2;
  }

  .download-button:active {
    background-color: #1565C0;
  }

  .button-container {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 1000;
  }
  </style>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>

  <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå‡πÅ‡∏•‡∏∞‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î -->
<div class="button-container">
  <button class="download-button" onclick="downloadPDF()">
      üìÑ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF
  </button>
  <button class="print-button" onclick="printDocument()">
      üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå
  </button>
</div>
<div class="a4-sheet">
  <!-- ‡∏´‡∏ô‡πâ‡∏≤ A4 ‡πÉ‡∏ä‡πâ table + inline -->
  <table role="presentation" cellspacing="0" cellpadding="0" style="width:190mm;margin:12mm auto;border-collapse:collapse;background:#fff;color:#111827;">

    <!-- ‡πÅ‡∏ñ‡∏ß‡∏ö‡∏ô: ‡πÇ‡∏•‡πÇ‡∏Å‡πâ (‡∏ã‡πâ‡∏≤‡∏¢) + ‡∏´‡∏±‡∏ß‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó (‡∏Ç‡∏ß‡∏≤)  == ‡∏à‡∏ö‡πÇ‡∏ã‡∏ô‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
    <tr>
      <!-- ‡∏ã‡πâ‡∏≤‡∏¢: ‡πÇ‡∏•‡πÇ‡∏Å‡πâ -->
      <td style="width:12%;vertical-align:top;">
        <table cellspacing="0" cellpadding="0" style="width:100%;border-collapse:collapse;">
          <tr>
            <td style="padding:4px 0; display: flex; justify-content: center;">
              <table cellspacing="0" cellpadding="0" style="width:20mm;height:20mm;">
                <tr><td style="text-align:center;font-size:12px;color:#6b7280;"><img src="picture/unit-logo.png" alt="" style="width: 100%; "></td></tr>
              </table>
            </td>
          </tr>
        </table>
      </td>

      <!-- ‡∏Ç‡∏ß‡∏≤: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó -->
      <td colspan="2" style="width:85%;vertical-align:middle;">
        <table cellspacing="0" cellpadding="0" style="width:100%;border-collapse:collapse;">
          <tr>
            <td style="font-size:20px;line-height:1.25;font-weight:700;padding:2px 8px 6px 8px;">
              ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏¢‡∏π‡∏ô‡∏¥‡∏ó ‡∏à‡∏≥‡∏Å‡∏±‡∏î
            </td>
          </tr>
          <tr>
            <td style="padding:6px 0 0 0;">
              <table cellspacing="0" cellpadding="0" style="width:100%;border-collapse:collapse;table-layout:fixed;">
                <tr>
                  <td style="width:44%;font-size:11px;padding:0 5px;text-align:left;">
                   90 ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ã‡∏µ‡∏î‡∏±‡∏ö‡πÄ‡∏ö‡∏¥‡πâ‡∏•‡∏¢‡∏π ‡∏ó‡∏≤‡∏ß‡πÄ‡∏ß‡∏≠‡∏£‡πå ‡∏ä‡∏±‡πâ‡∏ô 3 ‡∏´‡πâ‡∏≠‡∏á 310 ‡∏ñ‡∏ô‡∏ô‡∏£‡∏±‡∏ä‡∏î‡∏≤‡∏†‡∏¥‡πÄ‡∏©‡∏Å ‡πÅ‡∏Ç‡∏ß‡∏á‡∏´‡πâ‡∏ß‡∏¢‡∏Ç‡∏ß‡∏≤‡∏á ‡πÄ‡∏Ç‡∏ï‡∏´‡πâ‡∏ß‡∏¢‡∏Ç‡∏ß‡∏≤‡∏á ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£ 10310
                  </td>
                  <td style="width:28%;font-size:11px;text-align:center;">
                    Tel.  098 264 2890&nbsp;&nbsp;Fax. 036-342146
                  </td>
                  <td style="width:28%;font-size:11px;padding:0 5px;text-align:right;">
                    E-Mail : customerservice@unit.co.th
                  </td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
      </td>
    </tr>
    <!-- ========== ‡∏à‡∏ö‡πÅ‡∏ñ‡∏ß‡πÇ‡∏•‡πÇ‡∏Å‡πâ/‡∏´‡∏±‡∏ß‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ========== -->

    <!-- ‡πÅ‡∏ñ‡∏ß‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏ï‡πá‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á: ‡πÇ‡∏Ñ‡πâ‡∏î‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÑ‡∏õ‡∏ï‡∏¥‡∏î‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÇ‡∏•‡πÇ‡∏Å‡πâ -->
    <tr>
      <td colspan="3">
        <!-- ‡∏ß‡∏≤‡∏á ‚Äú‡πÇ‡∏Ñ‡πâ‡∏î‡∏≠‡∏∑‡πà‡∏ô‚Äù ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å‡∏ô‡∏µ‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ -->
        <!-- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: 3‚Äì4 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏≥‡πÑ‡∏ß‡πâ -->
        <table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse; table-layout:fixed;">
        <!-- ‡πÅ‡∏ñ‡∏ß‡∏•‡πà‡∏≤‡∏á 3 (4 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå) -->
        <tr style="line-height:1.15;">
            <td style="width:9.4%; font-size:11px; padding:0 6px; text-align: right;">
              ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ/ Tax ID
            </td>
            <td style="width:5%; font-size:11px; padding:0 6px; text-align:left;">
              1100110011001
            </td>
            <td style="width:4%; font-size:11px; padding:0 6px;">
              ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏ç‡πà
            </td>
            <td style="width:10%; font-size:20px; padding:0 6px; text-align:center;">
              ‡πÉ‡∏ö‡∏Ç‡∏≤‡∏¢‡∏™‡∏î/‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏µ
            </td>
          </tr>

          <!-- ‡πÅ‡∏ñ‡∏ß‡∏•‡πà‡∏≤‡∏á 4 (4 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå) -->
          <tr style="line-height:1.15;">
            <td style="width:10%; font-size:11px; padding:0 6px; text-align: right;"></td>
            <td style="width:3%; font-size:11px; padding:0 6px; text-align:left;"></td>
            <td style="width:3%; font-size:11px; padding:0 6px;"></td>
            <td style="width:11%; font-size:14px; padding:0 6px; text-align:center;">
              ‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤)
            </td>
          </tr>
        </table>

<!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ + ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ö‡∏¥‡∏• (‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô + ‡∏°‡∏∏‡∏°‡πÇ‡∏Ñ‡πâ‡∏á 28px) -->
<!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ + ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ö‡∏¥‡∏• (‡∏Ç‡∏≠‡∏ö‡∏ï‡∏£‡∏á + ‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô) -->
<table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse; table-layout:fixed; margin-top:8px;    margin-bottom: 10px;">
  <tr>
    <!-- ‡∏ã‡πâ‡∏≤‡∏¢: ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ -->
    <td style="width:49%; vertical-align:top;">
      <table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse;height: 193px;">
        <tr>
          <!-- ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏ö‡∏ï‡∏£‡∏á + ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô -->
          <td style="border:1px solid black; border-radius:0; padding:10px 12px;vertical-align:top;">
            <table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse;">
              <tr>
                <td style="font-size:12px; padding:2px 0;">
                  <span style="display:inline-flex; flex-direction:column; font-size:12px;">
                    ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤
                    <span style="font-size:11px;">Customer</span>
                  </span>
                  <span style="margin-left:12px; font-size:11px;" id="customerno">‡∏™026</span>
                </td>
              </tr>
              <tr><td style="font-size:11px; padding:2px 0;" id="customerName">‡∏ô‡∏≤‡∏¢ ‡∏™‡∏≥‡πÄ‡∏£‡∏¥‡∏á ‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‡∏Ñ‡πâ‡∏ß‡∏á</td></tr>
              <tr><td style="font-size:11px; padding:2px 0;" id="customerAddress">44/10 ‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà 5 ‡∏ï.‡∏ó‡∏∏‡πà‡∏á‡∏õ‡∏£‡∏±‡∏á</td></tr>
              <tr><td style="font-size:11px; padding:2px 0;" id="customerAddress2">‡∏≠.‡∏™‡∏¥‡πÄ‡∏Å‡∏≤ ‡∏à.‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä</td></tr>
              <tr><td style="font-size:11px; padding:2px 0;" id="customerAddress3">‡∏à.‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä 90170</td></tr>
              <tr><td style="font-size:11px; padding:2px 0;">‡πÇ‡∏ó‡∏£. <span id="customerPhone"></span></td></tr>
              <tr>
                <td style="font-size:12px; padding:6px 0 2px 0; white-space:nowrap;">
                  <span style="font-size:11px;">‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ
                    <span>Tax ID</span>
                  </span>
                  <span style="margin-left:10px; font-size:11px;">3930300309135</span>
                  <span style="margin-left:14px; font-size:11px; display:inline-flex; align-items:center;">
                    <span style="width:12px; height:12px; border:1px solid #111827; display:inline-flex; align-items:center; justify-content:center; font-size:11px; line-height:12px;">‚úì</span>
                    <span style="margin-left:6px;">‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏ç‡πà</span>
                  </span>
                </td>
              </tr>
              <tr>
                <td style="font-size:12px; padding:2px 0;">
                  <span style="display:inline-flex; flex-direction:column; font-size:12px;">
                    ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á
                    <span style="font-size:11px; ">Reference</span>
                  </span>
                  <span style="margin-left:10px; font-size:11px;" id="customerReference"></span>
                </td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </td>

    <!-- ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏•‡∏≤‡∏á -->
    <td style="width:2%;">&nbsp;</td>

    <!-- ‡∏Ç‡∏ß‡∏≤: ‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà/‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà/‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï/‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î -->
    <td style="width:49%; vertical-align:top;">
      <table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse;height: 193px;">
        <tr>
          <!-- ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏ö‡∏ï‡∏£‡∏á + ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô -->
          <td style="border:1px solid black; border-radius:0; padding:10px 12px; height:176px; vertical-align:top;">
            <table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse;">
              <tr>
                <td style="width:27%; font-size:11px; padding:2px 0;">
                  ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà<br><span style="font-size:11px;">No.</span>
                </td>
                <td style="width:27%; font-size:11px; padding:2px 0; text-align:left;" id="quotationNumber">AI68-07001</td>
              </tr>
              <tr>
                <td style="font-size:11px; padding:2px 0;">
                  ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà<br><span style="font-size:11px;">Date</span>
                </td>
                <td style="font-size:11px; padding:2px 0; text-align:left;" id="quotationDate">07/07/68</td>
              </tr>
              <tr>
                <td style="font-size:11px; padding:8px 0 2px 0;">
                  ‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï<br><span style="font-size:11px;">Credit</span>
                </td>
                <td style="font-size:11px; padding:8px 0 2px 0; text-align:left;" id="quotationDueDate">
                  0&nbsp;<span style="font-size:11px; ">‡∏ß‡∏±‡∏ô</span>
                  <span style="font-size:11px; margin-left:8px;">Days</span>
                </td>
                                <td style="font-size:11px; padding:2px 0;">
                  ‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î<br><span style="font-size:11px;">Due Date</span>
                </td>
                <td style="font-size:11px; padding:2px 0; text-align:left;" id="quotationDueDateTo">07/07/68</td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<!-- ‡∏Å‡∏£‡∏≠‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ï‡∏≤‡∏°‡∏†‡∏≤‡∏û (‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á ‡∏Ñ‡∏∏‡∏°‡∏î‡πâ‡∏ß‡∏¢ table+inline ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô) -->
<table cellspacing="0" cellpadding="0"
  style="width:100%; border-collapse:collapse; table-layout:fixed; font-size:12px;
         border:1pt solid #000; outline:1pt solid #000; outline-offset:-1pt;">
  <!-- ‡πÅ‡∏ñ‡∏ß‡∏ö‡∏ô (‡∏´‡∏±‡∏ß‡∏ö‡∏ô‡∏¢‡∏≤‡∏ß) : 3 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå -->
  <tr>
    <td style="width:8%; height:36px; border-right:1pt solid #000; border-bottom:1pt solid #000; font-size: 11px;text-align: center;">‡∏•‡∏≥‡∏î‡∏±‡∏ö<br>No.</td>
    <td style="width:72%; height:36px; border-right:1pt solid #000; border-bottom:1pt solid #000; font-size: 11px;text-align: center;">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£<br>Items/Descriptions</td>
    <td style="width:14%; height:36px;font-size: 11px;text-align: center; border-bottom:1pt solid #000;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô<br>Amount</td>
  </tr>

  <!-- Dynamic content will be inserted here by JavaScript -->
  <tbody id="quotationItems">
    <!-- Items will be populated dynamically -->
  </tbody>

  <!-- <tr>
    <td style="border-right:1pt solid #000; border-top:1pt solid #000;height: 40px;font-size: 11px;text-align: center">1</td>
    <td style="border-right:1pt solid #000; border-top:1pt solid #000;padding: 0 10px;font-size: 11px;">‡∏£‡∏±‡∏ö‡∏°‡∏±‡∏î‡∏à‡∏≥‡∏Ñ‡πà‡∏≤‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 10 ‡∏Å.‡∏Ñ. 68</td>
    <td style="border-top:1pt solid #000;text-align: right;padding:4px 10px;">1,401,87</td>
  </tr>
    <tr>
    <td style="border-right:1pt solid;height: 40px;font-size: 11px;text-align: center"></td>
    <td style="border-right:1pt solid;padding: 0 10px;font-size: 11px;"></td>
    <td style="text-align: right;padding:4px 10px;"></td>
  </tr>
    <tr>
    <td style="border-right:1pt solid;height: 40px;font-size: 11px;text-align: center"></td>
    <td style="border-right:1pt solid;padding: 0 10px;font-size: 11px;"></td>
    <td style="text-align: right;padding:4px 10px;"></td>
  </tr>
    <tr>
    <td style="border-right:1pt solid;height: 40px;font-size: 11px;text-align: center"></td>
    <td style="border-right:1pt solid;padding: 0 10px;font-size: 11px;"></td>
    <td style="text-align: right;padding:4px 10px;"></td>
  </tr>
    <tr>
    <td style="border-right:1pt solid;height: 40px;font-size: 11px;text-align: center"></td>
    <td style="border-right:1pt solid;padding: 0 10px;font-size: 11px;"></td>
    <td style="text-align: right;padding:4px 10px;"></td>
  </tr>
    <tr>
    <td style="border-right:1pt solid;height: 40px;font-size: 11px;text-align: center"></td>
    <td style="border-right:1pt solid;padding: 0 10px;font-size: 11px;"></td>
    <td style="text-align: right;padding:4px 10px;"></td>
  </tr>
    <tr>
    <td style="border-right:1pt solid;height: 40px;font-size: 11px;text-align: center"></td>
    <td style="border-right:1pt solid;padding: 0 10px;font-size: 11px;"></td>
    <td style="text-align: right;padding:4px 10px;"></td>
  </tr>
    <tr>
    <td style="border-right:1pt solid;height: 40px;font-size: 11px;text-align: center"></td>
    <td style="border-right:1pt solid;padding: 0 10px;font-size: 11px;"></td>
    <td style="text-align: right;padding:4px 10px;"></td>
  </tr>
    <tr>
    <td style="border-right:1pt solid;height: 40px;font-size: 11px;text-align: center"></td>
    <td style="border-right:1pt solid;padding: 0 10px;font-size: 11px;"></td>
    <td style="text-align: right;padding:4px 10px;"></td>
  </tr>
    <tr>
    <td style="border-right:1pt solid #000;height: 40px;font-size: 11px;text-align: center"></td>
    <td style="border-right:1pt solid #000;;padding: 0 10px;font-size: 11px;"></td>
    <td style="border-bottom:1pt solid #000;text-align: right;padding:4px 10px;"></td>
  </tr> -->

  <!-- ‡πÅ‡∏ñ‡∏ß‡πÅ‡∏ñ‡∏ö‡∏•‡πà‡∏≤‡∏á‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 1 (‡∏¢‡∏≤‡∏ß‡∏ó‡∏±‡πâ‡∏á‡πÅ‡∏ñ‡∏ß) : 3 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå -->
<tr>
  <!-- ‡∏£‡∏ß‡∏° ‡∏ã‡πâ‡∏≤‡∏¢ + ‡∏Å‡∏•‡∏≤‡∏á -->
<td colspan="2"
    style="border-top:1pt solid #000; border-right:1pt solid #000; border-left:1pt solid #000; padding:0; height:14mm;">
  <table cellspacing="0" cellpadding="0"
         style="width:100%; border-collapse:collapse; table-layout:fixed; height:14mm;">
    <!-- ‡πÅ‡∏ñ‡∏ß‡πÅ‡∏£‡∏Å (‡∏ß‡πà‡∏≤‡∏á) -->
    <tr>
      <td style="width:60%; border-right:1pt solid #000; height:8mm;"></td>
      <td style="padding:4px 10px; height: 30px;    font-size: 11px;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô‡∏£‡∏ß‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏¥‡∏ô<br>Grand Total</td>
    </tr>
    <tr>
      <td style="width:60%; border-right:1pt solid #000; height:8mm;"></td>
      <td style="padding:4px 10px; height: 30px;    font-size: 11px;">‡∏´‡∏±‡∏Å ‡∏†‡∏≤‡∏©‡∏µ ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢<br>Withholding Tax</td>
    </tr>
    <!-- ‡πÅ‡∏ñ‡∏ß‡∏™‡∏≠‡∏á: ‡∏ß‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏´‡πâ‡∏ä‡∏¥‡∏î‡∏•‡πà‡∏≤‡∏á -->
    <tr>
      <td style="width:60%; border-right:1pt solid #000; height:6mm; position:relative; padding:0 6px;">
        <span style="position:absolute; left:6px; right:6px; bottom:2px; display:block; text-align:center;">
          ‡∏ú‡∏¥‡∏î ‡∏ï‡∏Å ‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô E.&amp;O.E.
        </span>
      </td>
      <td style="height: 30px;padding:4px 10px;font-size: 11px;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏†‡∏≤‡∏©‡∏µ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏° <span style="padding-left: 8px;">7.00%</span><br>Vat</td>
    </tr>
  </table>
</td>

  <!-- ‡∏Ç‡∏ß‡∏≤: ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° -->
 <td style="border-top:1pt solid #000; padding:0;">
  <table cellspacing="0" cellpadding="0"
         style="width:100%; height:14mm; border-collapse:collapse; table-layout:fixed;">
    <tr>
      <td style="height:30px;padding:4px 10px;text-align: right;font-size: 11px;" id="subtotal">1,401,81</td>     <!-- ‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 1 -->
    </tr>
    <tr>
      <td style="height:30px;padding:4px 10px;text-align: right;font-size: 11px;" id="taxAmount">98.13</td>     <!-- ‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 1 -->
    </tr>
    <tr>
      <td style="height:30px;padding:4px 10px;text-align: right; font-size: 11px;" id="vatAmount">98.13</td>     <!-- ‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 2 -->
    </tr>
  </table>
</td>
</tr>


  <!-- ‡πÅ‡∏ñ‡∏ß‡πÅ‡∏ñ‡∏ö‡∏•‡πà‡∏≤‡∏á‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 2 (‡∏°‡∏µ‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏≠‡∏á‡πÅ‡∏ñ‡∏ö‡∏•‡πà‡∏≤‡∏á) -->
<tr>
  <!-- ‡∏£‡∏ß‡∏° ‡∏ã‡πâ‡∏≤‡∏¢ + ‡∏Å‡∏•‡∏≤‡∏á -->
  <td colspan="2" style="border-top:1pt solid #000; border-right:1pt solid #000; border-left:1pt solid #000; padding:0; height:14mm;">
    <!-- ‡∏Ç‡πâ‡∏≤‡∏á‡πÉ‡∏ô‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô 2 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏±‡πâ‡∏á‡∏Å‡∏•‡∏≤‡∏á -->
    <table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse; table-layout:fixed; height:14mm;">
      <tr>
        <td style="width:60%; border-right:1pt solid #000; text-align:center;    font-size: 18px;" id="totalText">(‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏û‡∏±‡∏ô‡∏´‡πâ‡∏≤‡∏£‡πâ‡∏≠‡∏¢‡∏ö‡∏≤‡∏ó‡∏ñ‡πâ‡∏ß‡∏ô).</td>
        <td style="height: 30px;padding:4px 10px;font-size: 11px;">‡∏£‡∏ß‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏¥‡∏ô<br>Amount</td>
      </tr>
    </table>
  </td>

  <!-- ‡∏Ç‡∏ß‡∏≤: ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° -->
  <td style="border-top:1pt solid #000;padding:4px 10px;text-align: right; font-size: 11px;" id="grandTotal">1,500.00</td>
</tr>
</table>
<!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏ö + ‡πÅ‡∏ö‡πà‡∏á 3 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå (‡πÄ‡∏ï‡∏¥‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß, font 11px) -->
<table cellspacing="0" cellpadding="0"
  style="width:190mm; height:160px; margin-top:10px; border-collapse:collapse; table-layout:fixed;
         border:1pt solid #000; outline:1pt solid #000; outline-offset:-1pt; font-size:11px;
         -webkit-print-color-adjust:exact; print-color-adjust:exact;">

  <tr>
    <!-- ‡∏ã‡πâ‡∏≤‡∏¢ -->
    <td style="width:40%; border-right:1pt solid #000; padding:8px 10px; vertical-align:top;">
      <table cellspacing="0" cellpadding="0" style="width:100%; height:100%; border-collapse:collapse;">
        <tr>
          <td style="vertical-align:top; padding-bottom:6px;">
            ‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏°‡∏±‡∏î‡∏à‡∏≥‡∏â‡∏ö‡∏±‡∏ö‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏ï‡πà‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏°‡∏≠‡∏ö‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡πÅ‡∏•‡∏∞
            ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô ‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡∏≤‡∏°‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß
          </td>
        </tr>
        <tr>
          <!-- ‡πÄ‡∏™‡πâ‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏±‡∏Å + ‡∏õ‡πâ‡∏≤‡∏¢‡∏Å‡∏≥‡∏Å‡∏±‡∏ö ‡∏ä‡∏¥‡∏î‡∏•‡πà‡∏≤‡∏á -->
          <td style="vertical-align:bottom;">
            <table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse;">
              <tr>
                <td style="border-bottom:1pt solid #000; height:14px;"></td>
              </tr>
              <tr>
                <td style="text-align:center; padding-top:4px;">‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏±‡∏Å/ Guest name</td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </td>

    <!-- ‡∏Å‡∏•‡∏≤‡∏á -->
    <td style="width:35%; border-right:1pt solid #000; padding:8px 10px; vertical-align:top;">
      <table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse;">
        <tr>
          <td colspan="4" style="padding-bottom:6px;">
            ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô ‡πÇ‡∏î‡∏¢
            <span style="display:inline-block; width:12px; height:12px; border:1pt solid #000; margin:0 6px 0 10px;"></span> ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î
            <span style="display:inline-block; width:12px; height:12px; border:1pt solid #000; margin:0 6px 0 14px;"></span> ‡πÄ‡∏ä‡πá‡∏Ñ
          </td>
        </tr>

        <!-- ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ / ‡∏™‡∏≤‡∏Ç‡∏≤ -->
<!-- ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ / ‡∏™‡∏≤‡∏Ç‡∏≤ -->
<table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse; table-layout:fixed;">
  <tr>
    <td style="white-space:nowrap; padding-right:6px; width:55px;">‡πÄ‡∏ä‡πá‡∏Ñ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</td>
    <td style="border-bottom:1pt solid #000;">&nbsp;</td>
    <td style="white-space:nowrap; padding:0 6px 0 12px; width:40px;">‡∏™‡∏≤‡∏Ç‡∏≤</td>
    <td style="border-bottom:1pt solid #000;">&nbsp;</td>
  </tr>
</table>
<table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse;"><tr><td style="height:8px;"></td></tr></table>

<!-- ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà / ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà -->
<table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse; table-layout:fixed;">
  <tr>
    <td style="white-space:nowrap; padding-right:6px; width:30px;">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà</td>
    <td style="border-bottom:1pt solid #000;">&nbsp;</td>
    <td style="white-space:nowrap; padding:0 6px 0 12px; width:30px;">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</td>
    <td>
      <table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse; table-layout:fixed;">
        <tr>
          <td style="border-bottom:1pt solid #000; width:28%;">&nbsp;</td>
          <td style="width:8%; text-align:center;">/</td>
          <td style="border-bottom:1pt solid #000; width:28%;">&nbsp;</td>
          <td style="width:8%; text-align:center;">/</td>
          <td style="border-bottom:1pt solid #000; width:28%;">&nbsp;</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse;"><tr><td style="height:8px;"></td></tr></table>

<!-- ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô -->
<table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse; table-layout:fixed;">
  <tr>
    <td style="white-space:nowrap; padding-right:6px; width:50px;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</td>
    <td colspan="3" style="border-bottom:1pt solid #000;">&nbsp;</td>
  </tr>
</table>
<table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse;"><tr><td style="height:8px;"></td></tr></table>

<!-- ‡∏†‡∏≤‡∏©‡∏µ‡∏´‡∏±‡∏Å ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢ -->
<table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse; table-layout:fixed;">
  <tr>
    <td style="white-space:nowrap; padding-right:6px; width:80px;">‡∏†‡∏≤‡∏©‡∏µ‡∏´‡∏±‡∏Å ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢</td>
    <td colspan="3" style="border-bottom:1pt solid #000;">&nbsp;</td>
  </tr>
</table>

<!-- ‡πÄ‡∏™‡πâ‡∏ô‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥ + ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà -->
<table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse;"><tr><td style="height:14px;"></td></tr></table>
<table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse; table-layout:fixed;">
  <tr>
    <td colspan="2" style="border-bottom:1pt solid #000;">&nbsp;</td>
    <td style="width:10px;"></td>
    <td style="border-bottom:1pt solid #000;    width: 105px;">&nbsp;</td>
  </tr>
  <tr>
    <td colspan="2" style="text-align:center; padding-top:4px;">‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥/ Prepared by</td>
    <td></td>
    <td style="text-align:center; padding-top:4px;">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà/ Date</td>
  </tr>
</table>


    <!-- ‡∏Ç‡∏ß‡∏≤ -->
    <td style="width:25%; padding:8px 10px; vertical-align:top;">
      <table cellspacing="0" cellpadding="0" style="width:100%; height:100%; border-collapse:collapse;">
        <tr>
          <td style="vertical-align:top; padding-bottom:6px;">
            ‡πÉ‡∏ô‡∏ô‡∏≤‡∏°<br>
            ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡πÄ‡∏≠‡∏™‡∏û‡∏µ‡∏ß‡∏µ ‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏Å‡∏•‡πÄ‡∏°‡∏≠‡πÄ‡∏£‡∏ó ‡∏à‡∏≥‡∏Å‡∏±‡∏î
          </td>
        </tr>
        <tr>
          <!-- ‡πÄ‡∏™‡πâ‡∏ô‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏¥‡∏î‡∏•‡πà‡∏≤‡∏á -->
          <td style="vertical-align:bottom;">
            <table cellspacing="0" cellpadding="0" style="width:100%; border-collapse:collapse;">
              <tr>
                <td style="border-bottom:1pt solid #000; height:14px;"></td>
              </tr>
              <tr>
                <td style="text-align:center; padding-top:4px;">‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏°‡∏≠‡∏ö‡∏≠‡∏≥‡∏ô‡∏≤‡∏à/ Authorized Signature</td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>


    </td>
  </tr>
</table>
    </td>
    </tr>
</table>
</div>
<script>
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏±‡∏ö ID ‡∏à‡∏≤‡∏Å URL parameter
function getUrlParameter(name) {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get(name);
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å API
function loadReceiptData(receiptId) {
    if (!receiptId) {
        console.error('‡πÑ‡∏°‡πà‡∏û‡∏ö ID ‡∏Ç‡∏≠‡∏á‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à');
        return;
    }
    
    console.log('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ID:', receiptId);
    
    // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î endpoint 
    const endpoint = 'http://localhost:3000';
    
    $.ajax({
        url: `${endpoint}/api/get_quotation_by_id`,
        method: 'POST',
        dataType: 'json',
        contentType: 'application/json',
        data: JSON.stringify({
            id: receiptId,
            com_id: localStorage.getItem('com_id') || 9
        }),
        success: function(response) {
            console.log('API Response:', response);
            if (response.code === 200) {
                // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
                updateReceiptDisplay(response.result);
            } else {
                console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:', response.result);
                alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ: ' + (response.result || '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏'));
            }
        },
        error: function(xhr, status, error) {
            console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠:', error);
            alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå');
        }
    });
}

// ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Mock ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö
const mockProductData = [
  {
    name: '‡∏Ñ‡πà‡∏≤‡∏°‡∏±‡∏î‡∏à‡∏≥‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å',
    description: '‡∏°‡∏±‡∏î‡∏à‡∏≥‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 10-15 ‡∏Å.‡∏Ñ. 68',
    quantity: '1',
    unit_price: '1500.00',
    amount: '1500.00'
  },
  {
    name: '‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°',
    description: '‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏ï‡πà‡∏≤‡∏á‡πÜ',
    quantity: '1',
    unit_price: '500.00',
    amount: '500.00'
  }
];

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
function updateReceiptDisplay(data) {
// ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤
  $('#customerno').text(data.cus_detail.cus_no);
  $('#customerName').text(data.cus_name);
  
  // ‡πÅ‡∏ö‡πà‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏≤‡∏Å customerAddress
  var fullAddress = data.cus_detail.cus_addr || '';
  
  // ‡∏´‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏≥‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà
  var tambonIndex = fullAddress.search(/‡∏ï\.|‡∏ï‡∏≥‡∏ö‡∏•|‡πÅ‡∏Ç‡∏ß‡∏á/);
  var amphoeIndex = fullAddress.search(/‡∏≠\.|‡∏≠‡∏≥‡πÄ‡∏†‡∏≠|‡πÄ‡∏Ç‡∏ï/);
  var provinceIndex = fullAddress.search(/‡∏à\.|‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î|‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£|‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø|‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û ‡∏Ø/);
  
  if (tambonIndex !== -1) {
    // ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà 1: ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏•‡∏±‡∏Å (‡∏Å‡πà‡∏≠‡∏ô‡∏ï‡∏≥‡∏ö‡∏•)
    $('#customerAddress').text(fullAddress.substring(0, tambonIndex).trim());
    
    if (provinceIndex !== -1) {
      // ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà 2: ‡∏ï‡∏≥‡∏ö‡∏• ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠
      $('#customerAddress2').text(fullAddress.substring(tambonIndex, provinceIndex).trim());
      // ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà 3: ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î ‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå
      $('#customerAddress3').text(fullAddress.substring(provinceIndex).trim());
    }
  }
  $('#customerPhone').text(data.cus_detail.cus_phone);
  $('#customerReference').text(data.cus_detail.cus_refer);

// ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤
  $('#quotationNumber').text(data.tx);
  $('#quotationDate').text(data.doc_date);
  $('#quotationDueDate').text(data.doc_detail.deadline);
  $('#quotationDueDateTo').text(data.due_date);
  $('#quotationPaymentTerms').text(data.quo_payment_terms);

  // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
  const items = data.product_byuser;
  
  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
  if (!items || items.length === 0) {
    console.log('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ - ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Mock');
    // ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Mock ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
    const mockItems = mockProductData.slice(0, 9);
    const emptyRows = [];
    
    // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ñ‡∏ß‡∏ß‡πà‡∏≤‡∏á‡∏à‡∏ô‡∏Ñ‡∏£‡∏ö 9 ‡πÅ‡∏ñ‡∏ß
    for (let i = mockItems.length; i < 9; i++) {
      emptyRows.push(`
        <tr>
          <td style="border-right:1pt solid #000; border-top:0pt solid #000;height: 40px;font-size: 11px;text-align: center"></td>
          <td style="border-right:1pt solid #000; border-top:0pt solid #000;padding: 0 10px;font-size: 11px;"></td>
          <td style="border-top:0pt solid #000;text-align: right;padding:4px 10px;"></td>
        </tr>
      `);
    }
    
    $('#quotationItems').html([
      ...mockItems.map((item, index) => `
        <tr>
          <td style="border-right:1pt solid #000; border-top:0pt solid #000;height: 40px;font-size: 11px;text-align: center">${index + 1}</td>
          <td style="border-right:1pt solid #000; border-top:0pt solid #000;padding: 0 10px;font-size: 11px;">${item.name}</td>
          <td style="border-top:0pt solid #000;text-align: center;font-size: 11px;">${parseFloat(item.amount).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
        </tr>
      `),
      ...emptyRows
    ].join(''));
    
    // ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Mock ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏Ñ‡∏≤
    $('#subtotal').text('2,000.00');
    $('#taxAmount').text('0.00');
    $('#vatAmount').text('140.00');
    $('#grandTotal').text('2,140.00');
    $('#totalText').text('(‡∏™‡∏≠‡∏á‡∏û‡∏±‡∏ô‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏£‡πâ‡∏≠‡∏¢‡∏™‡∏µ‡πà‡∏™‡∏¥‡∏ö‡∏ö‡∏≤‡∏ó‡∏ñ‡πâ‡∏ß‡∏ô)');
  } else {
    // ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å API
    const limitedItems = items.slice(0, 9);
    const emptyRows = [];
    
    // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ñ‡∏ß‡∏ß‡πà‡∏≤‡∏á‡∏à‡∏ô‡∏Ñ‡∏£‡∏ö 9 ‡πÅ‡∏ñ‡∏ß
    for (let i = limitedItems.length; i < 9; i++) {
      emptyRows.push(`
        <tr>
          <td style="border-right:1pt solid #000; border-top:0pt solid #000;height: 40px;font-size: 11px;text-align: center"></td>
          <td style="border-right:1pt solid #000; border-top:0pt solid #000;padding: 0 10px;font-size: 11px;"></td>
          <td style="border-top:0pt solid #000;text-align: right;padding:4px 10px;"></td>
      </tr>
      `);
    }
    
    $('#quotationItems').html([
      ...limitedItems.map((item, index) => `
        <tr>
          <td style="border-right:1pt solid #000; border-top:0pt solid #000;height: 40px;font-size: 11px;text-align: center">${index + 1}</td>
          <td style="border-right:1pt solid #000; border-top:0pt solid #000;padding: 0 10px;font-size: 11px;">${item.name}</td>
          <td style="border-top:0pt solid #000;text-align: center;font-size: 11px;">${parseFloat(item.deposit_amount).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
        </tr>
      `),
      ...emptyRows
    ].join(''));
    
    // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á
    $('#subtotal').text(parseFloat(data.product_detail.product_totalAllProducts).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}));
    $('#totalDiscount').text(parseFloat(data.product_detail.product_totalDiscount).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}));
    $('#afterDiscount').text(parseFloat(data.product_detail.product_totalAfterDiscount).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}));
    $('#vatAmount').text(parseFloat(data.product_detail.product_totalTax).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}));
    
    // ‡∏£‡∏ß‡∏° withholdingTax ‡∏ó‡∏±‡πâ‡∏á 3 ‡∏≠‡∏±‡∏ô
    const withholdingTax1 = parseFloat(data.product_detail.product_withholdingTax) || 0;
    const withholdingTax2 = parseFloat(data.product_detail.product_withholdingTax2) || 0;
    const withholdingTax3 = parseFloat(data.product_detail.product_withholdingTax3) || 0;
    const totalWithholdingTax = withholdingTax1 + withholdingTax2 + withholdingTax3;
    $('#taxAmount').text(totalWithholdingTax.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}));
    
    $('#grandTotal').text(parseFloat(data.product_detail.product_totalAll).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}));

    // ‡πÅ‡∏õ‡∏•‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÑ‡∏ó‡∏¢
    const grandTotalAmount = parseFloat(data.product_detail.product_totalAll);
    const thaiText = convertToThaiText(grandTotalAmount);
    $('#totalText').text(`‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£: (${thaiText})`);
  }

  console.log('‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ checkbox
function updateCreatorDisplay() {
    const creatorName = localStorage.getItem('quotationCreatorName');
    const notShowName = localStorage.getItem('quotationNotShowName') === 'true';
    const signatureOption = localStorage.getItem('quotationSignatureOption') === 'true';
    
    const creatorElement = document.getElementById('creatorName');
    
    if (creatorElement && creatorName) {
        creatorElement.textContent = creatorName;
    }
    
    // ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ checkbox
    if (creatorElement) {
        if (notShowName) {
            // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥" ‡πÉ‡∏´‡πâ‡∏ã‡πà‡∏≠‡∏ô‡∏ä‡∏∑‡πà‡∏≠
            creatorElement.style.display = 'none';
        } else if (signatureOption) {
            // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å" ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠
            creatorElement.style.display = 'visible';
        } else {
            // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏•‡∏¢ ‡πÉ‡∏´‡πâ‡∏ã‡πà‡∏≠‡∏ô‡∏ä‡∏∑‡πà‡∏≠
            creatorElement.style.display = 'none';
        }
    }
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÑ‡∏ó‡∏¢
function convertToThaiText(number) {
    const thaiNumbers = ['‡∏®‡∏π‡∏ô‡∏¢‡πå', '‡∏´‡∏ô‡∏∂‡πà‡∏á', '‡∏™‡∏≠‡∏á', '‡∏™‡∏≤‡∏°', '‡∏™‡∏µ‡πà', '‡∏´‡πâ‡∏≤', '‡∏´‡∏Å', '‡πÄ‡∏à‡πá‡∏î', '‡πÅ‡∏õ‡∏î', '‡πÄ‡∏Å‡πâ‡∏≤'];
    const thaiUnits = ['', '‡∏™‡∏¥‡∏ö', '‡∏£‡πâ‡∏≠‡∏¢', '‡∏û‡∏±‡∏ô', '‡∏´‡∏°‡∏∑‡πà‡∏ô', '‡πÅ‡∏™‡∏ô', '‡∏•‡πâ‡∏≤‡∏ô'];
    
    if (number === 0) return '‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏≤‡∏ó‡∏ñ‡πâ‡∏ß‡∏ô';
    
    const integerPart = Math.floor(number);
    const decimalPart = Math.round((number - integerPart) * 100);
    
    let result = '';
    
    // ‡πÅ‡∏õ‡∏•‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ï‡πá‡∏°
    if (integerPart > 0) {
        const numStr = integerPart.toString();
        const len = numStr.length;
        
        for (let i = 0; i < len; i++) {
            const digit = parseInt(numStr[i]);
            const position = len - i - 1;
            
            if (digit !== 0) {
                if (position === 1 && digit === 1 && len > 1) {
                    result += '‡∏™‡∏¥‡∏ö';
                } else if (position === 1 && digit === 2) {
                    result += '‡∏¢‡∏µ‡πà‡∏™‡∏¥‡∏ö';
                } else if (position === 0 && digit === 1 && len > 1) {
                    result += '‡πÄ‡∏≠‡πá‡∏î';
                } else {
                    result += thaiNumbers[digit];
                    if (position > 0) {
                        result += thaiUnits[position];
                    }
                }
            }
        }
        result += '‡∏ö‡∏≤‡∏ó';
    }
    
    // ‡πÅ‡∏õ‡∏•‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏®‡∏ô‡∏¥‡∏¢‡∏°
    if (decimalPart > 0) {
        const decimalStr = decimalPart.toString();
        for (let i = 0; i < decimalStr.length; i++) {
            const digit = parseInt(decimalStr[i]);
            if (digit !== 0) {
                result += thaiNumbers[digit];
                if (i === 0) result += '‡∏™‡∏¥‡∏ö';
            }
        }
        result += '‡∏™‡∏ï‡∏≤‡∏á‡∏Ñ‡πå';
    } else {
        result += '‡∏ñ‡πâ‡∏ß‡∏ô';
    }
    
    return result;
}


// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF
function downloadPDF() {
  const elements = document.querySelectorAll(".a4-sheet");
  
  // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• tx 
  const txElement = document.getElementById('quotationNumber');
  const txValue = txElement ? txElement.textContent : '';
  const filename = `‡πÉ‡∏ö‡∏Ç‡∏≤‡∏¢‡∏™‡∏î${txValue}.pdf`;
  
  // ‡∏™‡∏£‡πâ‡∏≤‡∏á PDF ‡πÉ‡∏´‡∏°‡πà
  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF('p', 'mm', 'a4');
  
  let pageIndex = 0;
  
  // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≠‡πÑ‡∏õ
  function processNextPage(index) {
    if (index >= elements.length) {
      // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å PDF ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏£‡πá‡∏à
      pdf.save(filename);

      return;
    }
    
    const element = elements[index];
    
    // ‡∏™‡∏£‡πâ‡∏≤‡∏á canvas ‡∏à‡∏≤‡∏Å element
    html2canvas(element, {
      scale: 2,
      useCORS: true,
      allowTaint: true,
      scrollX: 0,
      scrollY: 0,
      height: 1100,
      windowHeight: 1100
    }).then(function(canvas) {
      const imgData = canvas.toDataURL('image/jpeg', 1.0);
      
      // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô PDF (‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å)
      if (index > 0) {
        pdf.addPage();
      }
      
      const imgWidth = 210; // A4 width in mm
      const pageHeight = 297; // A4 height in mm
      const imgHeight = (canvas.height * imgWidth) / canvas.width;
      let heightLeft = imgHeight;
      let position = 0;
      
      pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
      heightLeft -= pageHeight;
      
      while (heightLeft >= 0) {
        position = heightLeft - imgHeight;
        pdf.addPage();
        pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
        heightLeft -= pageHeight;
      }
      
      // ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≠‡πÑ‡∏õ
      processNextPage(index + 1);
    }).catch(function(error) {
      console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á canvas:', error);
      alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á PDF: ' + error.message);
    });
  }
  
  // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡πâ‡∏≤
  processNextPage(0);
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏¥‡∏°‡∏û‡πå
function printDocument() {
    // ‡∏ã‡πà‡∏≠‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå‡πÅ‡∏•‡∏∞‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏Å‡πà‡∏≠‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå
    const buttons = document.querySelectorAll('.print-button, .download-button, .button-container');
    buttons.forEach(button => {
        button.style.display = 'none';
    });
    
    // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡∏≠‡∏á‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå
    window.print();
    
    // ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏´‡∏•‡∏±‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏™‡∏£‡πá‡∏à
    setTimeout(() => {
        buttons.forEach(button => {
            button.style.display = '';
        });
    }, 1000);
}


// ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏£‡πá‡∏à
$(document).ready(function() {
    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ checkbox
    updateCreatorDisplay();
    
    const Id = getUrlParameter('id');
    if (Id) {
        console.log('‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö ID :', Id);
        // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å API
        loadReceiptData(Id);
    } else {
        console.log('‡πÑ‡∏°‡πà‡∏û‡∏ö ID');
    }
});
</script>
</body>
</html>
